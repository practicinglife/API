!function(){"use strict";function t(t){throw new RangeError(jt[t])}function r(t,r){for(var e=t.length,n=[];e--;)n[e]=r(t[e]);return n}function e(t,e){var n=t.split("@"),o="";return n.length>1&&(o=n[0]+"@",t=n[1]),o+r((t=t.replace(xt,".")).split("."),e).join(".")}function n(t){for(var r,e,n=[],o=0,i=t.length;o<i;)(r=t.charCodeAt(o++))>=55296&&r<=56319&&o<i?56320==(64512&(e=t.charCodeAt(o++)))?n.push(((1023&r)<<10)+(1023&e)+65536):(n.push(r),o--):n.push(r);return n}function o(t,r){return t+22+75*(t<26)-((0!=r)<<5)}function i(t,r,e){var n=0;for(t=e?Mt(t/It):t>>1,t+=Mt(t/r);t>Lt*Tt>>1;n+=Pt)t=Mt(t/Lt);return Mt(n+(Lt+1)*t/(t+Ot))}function s(r){var e,s,h,a,u,f,c,l,p,g,y,m,v,d,w,b=[];for(m=(r=n(r)).length,e=Bt,s=0,u=Ct,f=0;f<m;++f)(y=r[f])<128&&b.push(Dt(y));for(h=a=b.length,a&&b.push(St);h<m;){for(c=_t,f=0;f<m;++f)(y=r[f])>=e&&y<c&&(c=y);for(c-e>Mt((_t-s)/(v=h+1))&&t("overflow"),s+=(c-e)*v,e=c,f=0;f<m;++f)if((y=r[f])<e&&++s>_t&&t("overflow"),y==e){for(l=s,p=Pt;g=p<=u?Ut:p>=u+Tt?Tt:p-u,!(l<g);p+=Pt)w=l-g,d=Pt-g,b.push(Dt(o(g+w%d,0))),l=Mt(w/d);b.push(Dt(o(l,0))),u=i(s,v,h==a),s=0,++h}++s,++e}return b.join("")}function h(t){return e(t,function(t){return Yt.test(t)?"xn--"+s(t):t})}function a(){zt=!0;for(var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",r=0,e=t.length;r<e;++r)qt[r]=t[r],Nt[t.charCodeAt(r)]=r;Nt["-".charCodeAt(0)]=62,Nt["_".charCodeAt(0)]=63}function u(t){zt||a();var r,e,n,o,i,s,h=t.length;if(h%4>0)throw new Error("Invalid string. Length must be a multiple of 4");i="="===t[h-2]?2:"="===t[h-1]?1:0,s=new Ft(3*h/4-i),n=i>0?h-4:h;var u=0;for(r=0,e=0;r<n;r+=4,e+=3)o=Nt[t.charCodeAt(r)]<<18|Nt[t.charCodeAt(r+1)]<<12|Nt[t.charCodeAt(r+2)]<<6|Nt[t.charCodeAt(r+3)],s[u++]=o>>16&255,s[u++]=o>>8&255,s[u++]=255&o;return 2===i?(o=Nt[t.charCodeAt(r)]<<2|Nt[t.charCodeAt(r+1)]>>4,s[u++]=255&o):1===i&&(o=Nt[t.charCodeAt(r)]<<10|Nt[t.charCodeAt(r+1)]<<4|Nt[t.charCodeAt(r+2)]>>2,s[u++]=o>>8&255,s[u++]=255&o),s}function f(t){return qt[t>>18&63]+qt[t>>12&63]+qt[t>>6&63]+qt[63&t]}function c(t,r,e){for(var n,o=[],i=r;i<e;i+=3)n=(t[i]<<16)+(t[i+1]<<8)+t[i+2],o.push(f(n));return o.join("")}function l(t){zt||a();for(var r,e=t.length,n=e%3,o="",i=[],s=0,h=e-n;s<h;s+=16383)i.push(c(t,s,s+16383>h?h:s+16383));return 1===n?(r=t[e-1],o+=qt[r>>2],o+=qt[r<<4&63],o+="=="):2===n&&(r=(t[e-2]<<8)+t[e-1],o+=qt[r>>10],o+=qt[r>>4&63],o+=qt[r<<2&63],o+="="),i.push(o),i.join("")}function p(t,r,e,n,o){var i,s,h=8*o-n-1,a=(1<<h)-1,u=a>>1,f=-7,c=e?o-1:0,l=e?-1:1,p=t[r+c];for(c+=l,i=p&(1<<-f)-1,p>>=-f,f+=h;f>0;i=256*i+t[r+c],c+=l,f-=8);for(s=i&(1<<-f)-1,i>>=-f,f+=n;f>0;s=256*s+t[r+c],c+=l,f-=8);if(0===i)i=1-u;else{if(i===a)return s?NaN:1/0*(p?-1:1);s+=Math.pow(2,n),i-=u}return(p?-1:1)*s*Math.pow(2,i-n)}function g(t,r,e,n,o,i){var s,h,a,u=8*i-o-1,f=(1<<u)-1,c=f>>1,l=23===o?Math.pow(2,-24)-Math.pow(2,-77):0,p=n?0:i-1,g=n?1:-1,y=r<0||0===r&&1/r<0?1:0;for(r=Math.abs(r),isNaN(r)||r===1/0?(h=isNaN(r)?1:0,s=f):(s=Math.floor(Math.log(r)/Math.LN2),r*(a=Math.pow(2,-s))<1&&(s--,a*=2),(r+=s+c>=1?l/a:l*Math.pow(2,1-c))*a>=2&&(s++,a/=2),s+c>=f?(h=0,s=f):s+c>=1?(h=(r*a-1)*Math.pow(2,o),s+=c):(h=r*Math.pow(2,c-1)*Math.pow(2,o),s=0));o>=8;t[e+p]=255&h,p+=g,h/=256,o-=8);for(s=s<<o|h,u+=o;u>0;t[e+p]=255&s,p+=g,s/=256,u-=8);t[e+p-g]|=128*y}function y(){return v.TYPED_ARRAY_SUPPORT?2147483647:1073741823}function m(t,r){if(y()<r)throw new RangeError("Invalid typed array length");return v.TYPED_ARRAY_SUPPORT?(t=new Uint8Array(r)).__proto__=v.prototype:(null===t&&(t=new v(r)),t.length=r),t}function v(t,r,e){if(!(v.TYPED_ARRAY_SUPPORT||this instanceof v))return new v(t,r,e);if("number"==typeof t){if("string"==typeof r)throw new Error("If encoding is specified then the first argument must be a string");return A(this,t)}return d(this,t,r,e)}function d(t,r,e,n){if("number"==typeof r)throw new TypeError('"value" argument must not be a number');return"undefined"!=typeof ArrayBuffer&&r instanceof ArrayBuffer?_(t,r,e,n):"string"==typeof r?E(t,r,e):P(t,r)}function w(t){if("number"!=typeof t)throw new TypeError('"size" argument must be a number');if(t<0)throw new RangeError('"size" argument must not be negative')}function b(t,r,e,n){return w(r),r<=0?m(t,r):void 0!==e?"string"==typeof n?m(t,r).fill(e,n):m(t,r).fill(e):m(t,r)}function A(t,r){if(w(r),t=m(t,r<0?0:0|U(r)),!v.TYPED_ARRAY_SUPPORT)for(var e=0;e<r;++e)t[e]=0;return t}function E(t,r,e){if("string"==typeof e&&""!==e||(e="utf8"),!v.isEncoding(e))throw new TypeError('"encoding" must be a valid string encoding');var n=0|O(r,e),o=(t=m(t,n)).write(r,e);return o!==n&&(t=t.slice(0,o)),t}function R(t,r){var e=r.length<0?0:0|U(r.length);t=m(t,e);for(var n=0;n<e;n+=1)t[n]=255&r[n];return t}function _(t,r,e,n){if(r.byteLength,e<0||r.byteLength<e)throw new RangeError("'offset' is out of bounds");if(r.byteLength<e+(n||0))throw new RangeError("'length' is out of bounds");return r=void 0===e&&void 0===n?new Uint8Array(r):void 0===n?new Uint8Array(r,e):new Uint8Array(r,e,n),v.TYPED_ARRAY_SUPPORT?(t=r).__proto__=v.prototype:t=R(t,r),t}function P(t,r){if(T(r)){var e=0|U(r.length);return 0===(t=m(t,e)).length?t:(r.copy(t,0,0,e),t)}if(r){if("undefined"!=typeof ArrayBuffer&&r.buffer instanceof ArrayBuffer||"length"in r)return"number"!=typeof r.length||ht(r.length)?m(t,0):R(t,r);if("Buffer"===r.type&&Zt(r.data))return R(t,r.data)}throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")}function U(t){if(t>=y())throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+y().toString(16)+" bytes");return 0|t}function T(t){return!(null==t||!t._isBuffer)}function O(t,r){if(T(t))return t.length;if("undefined"!=typeof ArrayBuffer&&"function"==typeof ArrayBuffer.isView&&(ArrayBuffer.isView(t)||t instanceof ArrayBuffer))return t.byteLength;"string"!=typeof t&&(t=""+t);var e=t.length;if(0===e)return 0;for(var n=!1;;)switch(r){case"ascii":case"latin1":case"binary":return e;case"utf8":case"utf-8":case void 0:return et(t).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*e;case"hex":return e>>>1;case"base64":return it(t).length;default:if(n)return et(t).length;r=(""+r).toLowerCase(),n=!0}}function I(t,r,e){var n=!1;if((void 0===r||r<0)&&(r=0),r>this.length)return"";if((void 0===e||e>this.length)&&(e=this.length),e<=0)return"";if(e>>>=0,r>>>=0,e<=r)return"";for(t||(t="utf8");;)switch(t){case"hex":return $(this,r,e);case"utf8":case"utf-8":return q(this,r,e);case"ascii":return F(this,r,e);case"latin1":case"binary":return z(this,r,e);case"base64":return k(this,r,e);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return Z(this,r,e);default:if(n)throw new TypeError("Unknown encoding: "+t);t=(t+"").toLowerCase(),n=!0}}function C(t,r,e){var n=t[r];t[r]=t[e],t[e]=n}function B(t,r,e,n,o){if(0===t.length)return-1;if("string"==typeof e?(n=e,e=0):e>2147483647?e=2147483647:e<-2147483648&&(e=-2147483648),e=+e,isNaN(e)&&(e=o?0:t.length-1),e<0&&(e=t.length+e),e>=t.length){if(o)return-1;e=t.length-1}else if(e<0){if(!o)return-1;e=0}if("string"==typeof r&&(r=v.from(r,n)),T(r))return 0===r.length?-1:S(t,r,e,n,o);if("number"==typeof r)return r&=255,v.TYPED_ARRAY_SUPPORT&&"function"==typeof Uint8Array.prototype.indexOf?o?Uint8Array.prototype.indexOf.call(t,r,e):Uint8Array.prototype.lastIndexOf.call(t,r,e):S(t,[r],e,n,o);throw new TypeError("val must be string, number or Buffer")}function S(t,r,e,n,o){function i(t,r){return 1===s?t[r]:t.readUInt16BE(r*s)}var s=1,h=t.length,a=r.length;if(void 0!==n&&("ucs2"===(n=String(n).toLowerCase())||"ucs-2"===n||"utf16le"===n||"utf-16le"===n)){if(t.length<2||r.length<2)return-1;s=2,h/=2,a/=2,e/=2}var u;if(o){var f=-1;for(u=e;u<h;u++)if(i(t,u)===i(r,-1===f?0:u-f)){if(-1===f&&(f=u),u-f+1===a)return f*s}else-1!==f&&(u-=u-f),f=-1}else for(e+a>h&&(e=h-a),u=e;u>=0;u--){for(var c=!0,l=0;l<a;l++)if(i(t,u+l)!==i(r,l)){c=!1;break}if(c)return u}return-1}function Y(t,r,e,n){e=Number(e)||0;var o=t.length-e;n?(n=Number(n))>o&&(n=o):n=o;var i=r.length;if(i%2!=0)throw new TypeError("Invalid hex string");n>i/2&&(n=i/2);for(var s=0;s<n;++s){var h=parseInt(r.substr(2*s,2),16);if(isNaN(h))return s;t[e+s]=h}return s}function x(t,r,e,n){return st(et(r,t.length-e),t,e,n)}function j(t,r,e,n){return st(nt(r),t,e,n)}function L(t,r,e,n){return j(t,r,e,n)}function M(t,r,e,n){return st(it(r),t,e,n)}function D(t,r,e,n){return st(ot(r,t.length-e),t,e,n)}function k(t,r,e){return l(0===r&&e===t.length?t:t.slice(r,e))}function q(t,r,e){e=Math.min(t.length,e);for(var n=[],o=r;o<e;){var i=t[o],s=null,h=i>239?4:i>223?3:i>191?2:1;if(o+h<=e){var a,u,f,c;switch(h){case 1:i<128&&(s=i);break;case 2:128==(192&(a=t[o+1]))&&(c=(31&i)<<6|63&a)>127&&(s=c);break;case 3:a=t[o+1],u=t[o+2],128==(192&a)&&128==(192&u)&&(c=(15&i)<<12|(63&a)<<6|63&u)>2047&&(c<55296||c>57343)&&(s=c);break;case 4:a=t[o+1],u=t[o+2],f=t[o+3],128==(192&a)&&128==(192&u)&&128==(192&f)&&(c=(15&i)<<18|(63&a)<<12|(63&u)<<6|63&f)>65535&&c<1114112&&(s=c)}}null===s?(s=65533,h=1):s>65535&&(s-=65536,n.push(s>>>10&1023|55296),s=56320|1023&s),n.push(s),o+=h}return N(n)}function N(t){var r=t.length;if(r<=Kt)return String.fromCharCode.apply(String,t);for(var e="",n=0;n<r;)e+=String.fromCharCode.apply(String,t.slice(n,n+=Kt));return e}function F(t,r,e){var n="";e=Math.min(t.length,e);for(var o=r;o<e;++o)n+=String.fromCharCode(127&t[o]);return n}function z(t,r,e){var n="";e=Math.min(t.length,e);for(var o=r;o<e;++o)n+=String.fromCharCode(t[o]);return n}function $(t,r,e){var n=t.length;(!r||r<0)&&(r=0),(!e||e<0||e>n)&&(e=n);for(var o="",i=r;i<e;++i)o+=rt(t[i]);return o}function Z(t,r,e){for(var n=t.slice(r,e),o="",i=0;i<n.length;i+=2)o+=String.fromCharCode(n[i]+256*n[i+1]);return o}function K(t,r,e){if(t%1!=0||t<0)throw new RangeError("offset is not uint");if(t+r>e)throw new RangeError("Trying to access beyond buffer length")}function V(t,r,e,n,o,i){if(!T(t))throw new TypeError('"buffer" argument must be a Buffer instance');if(r>o||r<i)throw new RangeError('"value" argument is out of bounds');if(e+n>t.length)throw new RangeError("Index out of range")}function H(t,r,e,n){r<0&&(r=65535+r+1);for(var o=0,i=Math.min(t.length-e,2);o<i;++o)t[e+o]=(r&255<<8*(n?o:1-o))>>>8*(n?o:1-o)}function J(t,r,e,n){r<0&&(r=4294967295+r+1);for(var o=0,i=Math.min(t.length-e,4);o<i;++o)t[e+o]=r>>>8*(n?o:3-o)&255}function G(t,r,e,n,o,i){if(e+n>t.length)throw new RangeError("Index out of range");if(e<0)throw new RangeError("Index out of range")}function Q(t,r,e,n,o){return o||G(t,r,e,4,3.4028234663852886e38,-3.4028234663852886e38),g(t,r,e,n,23,4),e+4}function W(t,r,e,n,o){return o||G(t,r,e,8,1.7976931348623157e308,-1.7976931348623157e308),g(t,r,e,n,52,8),e+8}function X(t){if((t=tt(t).replace(Vt,"")).length<2)return"";for(;t.length%4!=0;)t+="=";return t}function tt(t){return t.trim?t.trim():t.replace(/^\s+|\s+$/g,"")}function rt(t){return t<16?"0"+t.toString(16):t.toString(16)}function et(t,r){r=r||1/0;for(var e,n=t.length,o=null,i=[],s=0;s<n;++s){if((e=t.charCodeAt(s))>55295&&e<57344){if(!o){if(e>56319){(r-=3)>-1&&i.push(239,191,189);continue}if(s+1===n){(r-=3)>-1&&i.push(239,191,189);continue}o=e;continue}if(e<56320){(r-=3)>-1&&i.push(239,191,189),o=e;continue}e=65536+(o-55296<<10|e-56320)}else o&&(r-=3)>-1&&i.push(239,191,189);if(o=null,e<128){if((r-=1)<0)break;i.push(e)}else if(e<2048){if((r-=2)<0)break;i.push(e>>6|192,63&e|128)}else if(e<65536){if((r-=3)<0)break;i.push(e>>12|224,e>>6&63|128,63&e|128)}else{if(!(e<1114112))throw new Error("Invalid code point");if((r-=4)<0)break;i.push(e>>18|240,e>>12&63|128,e>>6&63|128,63&e|128)}}return i}function nt(t){for(var r=[],e=0;e<t.length;++e)r.push(255&t.charCodeAt(e));return r}function ot(t,r){for(var e,n,o,i=[],s=0;s<t.length&&!((r-=2)<0);++s)n=(e=t.charCodeAt(s))>>8,o=e%256,i.push(o),i.push(n);return i}function it(t){return u(X(t))}function st(t,r,e,n){for(var o=0;o<n&&!(o+e>=r.length||o>=t.length);++o)r[o+e]=t[o];return o}function ht(t){return t!==t}function at(t){return!!t.constructor&&"function"==typeof t.constructor.isBuffer&&t.constructor.isBuffer(t)}function ut(t){return"function"==typeof t.readFloatLE&&"function"==typeof t.slice&&at(t.slice(0,0))}function ft(t){return null===t}function ct(t){return null==t}function lt(t){return"string"==typeof t}function pt(t){return"object"==typeof t&&null!==t}function gt(t,r){return Object.prototype.hasOwnProperty.call(t,r)}function yt(t){switch(typeof t){case"string":return t;case"boolean":return t?"true":"false";case"number":return isFinite(t)?t:"";default:return""}}function mt(t,r,e,n){return r=r||"&",e=e||"=",null===t&&(t=void 0),"object"==typeof t?vt(Jt(t),function(n){var o=encodeURIComponent(yt(n))+e;return Ht(t[n])?vt(t[n],function(t){return o+encodeURIComponent(yt(t))}).join(r):o+encodeURIComponent(yt(t[n]))}).join(r):n?encodeURIComponent(yt(n))+e+encodeURIComponent(yt(t)):""}function vt(t,r){if(t.map)return t.map(r);for(var e=[],n=0;n<t.length;n++)e.push(r(t[n],n));return e}function dt(t,r,e,n){r=r||"&",e=e||"=";var o={};if("string"!=typeof t||0===t.length)return o;var i=/\+/g;t=t.split(r);var s=1e3;n&&"number"==typeof n.maxKeys&&(s=n.maxKeys);var h=t.length;s>0&&h>s&&(h=s);for(var a=0;a<h;++a){var u,f,c,l,p=t[a].replace(i,"%20"),g=p.indexOf(e);g>=0?(u=p.substr(0,g),f=p.substr(g+1)):(u=p,f=""),c=decodeURIComponent(u),l=decodeURIComponent(f),gt(o,c)?Ht(o[c])?o[c].push(l):o[c]=[o[c],l]:o[c]=l}return o}function wt(){this.protocol=null,this.slashes=null,this.auth=null,this.host=null,this.port=null,this.hostname=null,this.hash=null,this.search=null,this.query=null,this.pathname=null,this.path=null,this.href=null}function bt(t,r,e){if(t&&pt(t)&&t instanceof wt)return t;var n=new wt;return n.parse(t,r,e),n}function At(t,r,e,n){if(!lt(r))throw new TypeError("Parameter 'url' must be a string, not "+typeof r);var o=r.indexOf("?"),i=-1!==o&&o<r.indexOf("#")?"?":"#",s=r.split(i),a=/\\/g;s[0]=s[0].replace(a,"/");var u=r=s.join(i);if(u=u.trim(),!n&&1===r.split("#").length){var f=Xt.exec(u);if(f)return t.path=u,t.href=u,t.pathname=f[1],f[2]?(t.search=f[2],t.query=e?dt(t.search.substr(1)):t.search.substr(1)):e&&(t.search="",t.query={}),t}var c=Qt.exec(u);if(c){var l=(c=c[0]).toLowerCase();t.protocol=l,u=u.substr(c.length)}if(n||c||u.match(/^\/\/[^@\/]+@[^@\/]+/)){var p="//"===u.substr(0,2);!p||c&&ur[c]||(u=u.substr(2),t.slashes=!0)}var g,y,m,v;if(!ur[c]&&(p||c&&!fr[c])){var d=-1;for(g=0;g<or.length;g++)-1!==(y=u.indexOf(or[g]))&&(-1===d||y<d)&&(d=y);var w,b;for(-1!==(b=-1===d?u.lastIndexOf("@"):u.lastIndexOf("@",d))&&(w=u.slice(0,b),u=u.slice(b+1),t.auth=decodeURIComponent(w)),d=-1,g=0;g<nr.length;g++)-1!==(y=u.indexOf(nr[g]))&&(-1===d||y<d)&&(d=y);-1===d&&(d=u.length),t.host=u.slice(0,d),u=u.slice(d),Rt(t),t.hostname=t.hostname||"";var A="["===t.hostname[0]&&"]"===t.hostname[t.hostname.length-1];if(!A){var E=t.hostname.split(/\./);for(g=0,m=E.length;g<m;g++){var R=E[g];if(R&&!R.match(sr)){for(var _="",P=0,U=R.length;P<U;P++)R.charCodeAt(P)>127?_+="x":_+=R[P];if(!_.match(sr)){var T=E.slice(0,g),O=E.slice(g+1),I=R.match(hr);I&&(T.push(I[1]),O.unshift(I[2])),O.length&&(u="/"+O.join(".")+u),t.hostname=T.join(".");break}}}}t.hostname.length>ir?t.hostname="":t.hostname=t.hostname.toLowerCase(),A||(t.hostname=h(t.hostname)),v=t.port?":"+t.port:"";var C=t.hostname||"";t.host=C+v,t.href+=t.host,A&&(t.hostname=t.hostname.substr(1,t.hostname.length-2),"/"!==u[0]&&(u="/"+u))}if(!ar[l])for(g=0,m=er.length;g<m;g++){var B=er[g];if(-1!==u.indexOf(B)){var S=encodeURIComponent(B);S===B&&(S=escape(B)),u=u.split(B).join(S)}}var Y=u.indexOf("#");-1!==Y&&(t.hash=u.substr(Y),u=u.slice(0,Y));var x=u.indexOf("?");if(-1!==x?(t.search=u.substr(x),t.query=u.substr(x+1),e&&(t.query=dt(t.query)),u=u.slice(0,x)):e&&(t.search="",t.query={}),u&&(t.pathname=u),fr[l]&&t.hostname&&!t.pathname&&(t.pathname="/"),t.pathname||t.search){v=t.pathname||"";var j=t.search||"";t.path=v+j}return t.href=Et(t),t}function Et(t){var r=t.auth||"";r&&(r=(r=encodeURIComponent(r)).replace(/%3A/i,":"),r+="@");var e=t.protocol||"",n=t.pathname||"",o=t.hash||"",i=!1,s="";t.host?i=r+t.host:t.hostname&&(i=r+(-1===t.hostname.indexOf(":")?t.hostname:"["+this.hostname+"]"),t.port&&(i+=":"+t.port)),t.query&&pt(t.query)&&Object.keys(t.query).length&&(s=mt(t.query));var h=t.search||s&&"?"+s||"";return e&&":"!==e.substr(-1)&&(e+=":"),t.slashes||(!e||fr[e])&&!1!==i?(i="//"+(i||""),n&&"/"!==n.charAt(0)&&(n="/"+n)):i||(i=""),o&&"#"!==o.charAt(0)&&(o="#"+o),h&&"?"!==h.charAt(0)&&(h="?"+h),n=n.replace(/[?#]/g,function(t){return encodeURIComponent(t)}),h=h.replace("#","%23"),e+i+n+h+o}function Rt(t){var r=t.host,e=Wt.exec(r);e&&(":"!==(e=e[0])&&(t.port=e.substr(1)),r=r.substr(0,r.length-e.length)),r&&(t.hostname=r)}var _t=2147483647,Pt=36,Ut=1,Tt=26,Ot=38,It=700,Ct=72,Bt=128,St="-",Yt=/[^\x20-\x7E]/,xt=/[\x2E\u3002\uFF0E\uFF61]/g,jt={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},Lt=Pt-Ut,Mt=Math.floor,Dt=String.fromCharCode,kt="undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},qt=[],Nt=[],Ft="undefined"!=typeof Uint8Array?Uint8Array:Array,zt=!1,$t={}.toString,Zt=Array.isArray||function(t){return"[object Array]"==$t.call(t)};v.TYPED_ARRAY_SUPPORT=void 0===kt.TYPED_ARRAY_SUPPORT||kt.TYPED_ARRAY_SUPPORT,v.poolSize=8192,v._augment=function(t){return t.__proto__=v.prototype,t},v.from=function(t,r,e){return d(null,t,r,e)},v.TYPED_ARRAY_SUPPORT&&(v.prototype.__proto__=Uint8Array.prototype,v.__proto__=Uint8Array,"undefined"!=typeof Symbol&&Symbol.species&&v[Symbol.species]),v.alloc=function(t,r,e){return b(null,t,r,e)},v.allocUnsafe=function(t){return A(null,t)},v.allocUnsafeSlow=function(t){return A(null,t)},v.isBuffer=function(t){return null!=t&&(!!t._isBuffer||at(t)||ut(t))},v.compare=function(t,r){if(!T(t)||!T(r))throw new TypeError("Arguments must be Buffers");if(t===r)return 0;for(var e=t.length,n=r.length,o=0,i=Math.min(e,n);o<i;++o)if(t[o]!==r[o]){e=t[o],n=r[o];break}return e<n?-1:n<e?1:0},v.isEncoding=function(t){switch(String(t).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},v.concat=function(t,r){if(!Zt(t))throw new TypeError('"list" argument must be an Array of Buffers');if(0===t.length)return v.alloc(0);var e;if(void 0===r)for(r=0,e=0;e<t.length;++e)r+=t[e].length;var n=v.allocUnsafe(r),o=0;for(e=0;e<t.length;++e){var i=t[e];if(!T(i))throw new TypeError('"list" argument must be an Array of Buffers');i.copy(n,o),o+=i.length}return n},v.byteLength=O,v.prototype._isBuffer=!0,v.prototype.swap16=function(){var t=this.length;if(t%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var r=0;r<t;r+=2)C(this,r,r+1);return this},v.prototype.swap32=function(){var t=this.length;if(t%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var r=0;r<t;r+=4)C(this,r,r+3),C(this,r+1,r+2);return this},v.prototype.swap64=function(){var t=this.length;if(t%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var r=0;r<t;r+=8)C(this,r,r+7),C(this,r+1,r+6),C(this,r+2,r+5),C(this,r+3,r+4);return this},v.prototype.toString=function(){var t=0|this.length;return 0===t?"":0===arguments.length?q(this,0,t):I.apply(this,arguments)},v.prototype.equals=function(t){if(!T(t))throw new TypeError("Argument must be a Buffer");return this===t||0===v.compare(this,t)},v.prototype.inspect=function(){var t="";return this.length>0&&(t=this.toString("hex",0,50).match(/.{2}/g).join(" "),this.length>50&&(t+=" ... ")),"<Buffer "+t+">"},v.prototype.compare=function(t,r,e,n,o){if(!T(t))throw new TypeError("Argument must be a Buffer");if(void 0===r&&(r=0),void 0===e&&(e=t?t.length:0),void 0===n&&(n=0),void 0===o&&(o=this.length),r<0||e>t.length||n<0||o>this.length)throw new RangeError("out of range index");if(n>=o&&r>=e)return 0;if(n>=o)return-1;if(r>=e)return 1;if(r>>>=0,e>>>=0,n>>>=0,o>>>=0,this===t)return 0;for(var i=o-n,s=e-r,h=Math.min(i,s),a=this.slice(n,o),u=t.slice(r,e),f=0;f<h;++f)if(a[f]!==u[f]){i=a[f],s=u[f];break}return i<s?-1:s<i?1:0},v.prototype.includes=function(t,r,e){return-1!==this.indexOf(t,r,e)},v.prototype.indexOf=function(t,r,e){return B(this,t,r,e,!0)},v.prototype.lastIndexOf=function(t,r,e){return B(this,t,r,e,!1)},v.prototype.write=function(t,r,e,n){if(void 0===r)n="utf8",e=this.length,r=0;else if(void 0===e&&"string"==typeof r)n=r,e=this.length,r=0;else{if(!isFinite(r))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");r|=0,isFinite(e)?(e|=0,void 0===n&&(n="utf8")):(n=e,e=void 0)}var o=this.length-r;if((void 0===e||e>o)&&(e=o),t.length>0&&(e<0||r<0)||r>this.length)throw new RangeError("Attempt to write outside buffer bounds");n||(n="utf8");for(var i=!1;;)switch(n){case"hex":return Y(this,t,r,e);case"utf8":case"utf-8":return x(this,t,r,e);case"ascii":return j(this,t,r,e);case"latin1":case"binary":return L(this,t,r,e);case"base64":return M(this,t,r,e);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return D(this,t,r,e);default:if(i)throw new TypeError("Unknown encoding: "+n);n=(""+n).toLowerCase(),i=!0}},v.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var Kt=4096;v.prototype.slice=function(t,r){var e=this.length;t=~~t,r=void 0===r?e:~~r,t<0?(t+=e)<0&&(t=0):t>e&&(t=e),r<0?(r+=e)<0&&(r=0):r>e&&(r=e),r<t&&(r=t);var n;if(v.TYPED_ARRAY_SUPPORT)(n=this.subarray(t,r)).__proto__=v.prototype;else{var o=r-t;n=new v(o,void 0);for(var i=0;i<o;++i)n[i]=this[i+t]}return n},v.prototype.readUIntLE=function(t,r,e){t|=0,r|=0,e||K(t,r,this.length);for(var n=this[t],o=1,i=0;++i<r&&(o*=256);)n+=this[t+i]*o;return n},v.prototype.readUIntBE=function(t,r,e){t|=0,r|=0,e||K(t,r,this.length);for(var n=this[t+--r],o=1;r>0&&(o*=256);)n+=this[t+--r]*o;return n},v.prototype.readUInt8=function(t,r){return r||K(t,1,this.length),this[t]},v.prototype.readUInt16LE=function(t,r){return r||K(t,2,this.length),this[t]|this[t+1]<<8},v.prototype.readUInt16BE=function(t,r){return r||K(t,2,this.length),this[t]<<8|this[t+1]},v.prototype.readUInt32LE=function(t,r){return r||K(t,4,this.length),(this[t]|this[t+1]<<8|this[t+2]<<16)+16777216*this[t+3]},v.prototype.readUInt32BE=function(t,r){return r||K(t,4,this.length),16777216*this[t]+(this[t+1]<<16|this[t+2]<<8|this[t+3])},v.prototype.readIntLE=function(t,r,e){t|=0,r|=0,e||K(t,r,this.length);for(var n=this[t],o=1,i=0;++i<r&&(o*=256);)n+=this[t+i]*o;return o*=128,n>=o&&(n-=Math.pow(2,8*r)),n},v.prototype.readIntBE=function(t,r,e){t|=0,r|=0,e||K(t,r,this.length);for(var n=r,o=1,i=this[t+--n];n>0&&(o*=256);)i+=this[t+--n]*o;return o*=128,i>=o&&(i-=Math.pow(2,8*r)),i},v.prototype.readInt8=function(t,r){return r||K(t,1,this.length),128&this[t]?-1*(255-this[t]+1):this[t]},v.prototype.readInt16LE=function(t,r){r||K(t,2,this.length);var e=this[t]|this[t+1]<<8;return 32768&e?4294901760|e:e},v.prototype.readInt16BE=function(t,r){r||K(t,2,this.length);var e=this[t+1]|this[t]<<8;return 32768&e?4294901760|e:e},v.prototype.readInt32LE=function(t,r){return r||K(t,4,this.length),this[t]|this[t+1]<<8|this[t+2]<<16|this[t+3]<<24},v.prototype.readInt32BE=function(t,r){return r||K(t,4,this.length),this[t]<<24|this[t+1]<<16|this[t+2]<<8|this[t+3]},v.prototype.readFloatLE=function(t,r){return r||K(t,4,this.length),p(this,t,!0,23,4)},v.prototype.readFloatBE=function(t,r){return r||K(t,4,this.length),p(this,t,!1,23,4)},v.prototype.readDoubleLE=function(t,r){return r||K(t,8,this.length),p(this,t,!0,52,8)},v.prototype.readDoubleBE=function(t,r){return r||K(t,8,this.length),p(this,t,!1,52,8)},v.prototype.writeUIntLE=function(t,r,e,n){t=+t,r|=0,e|=0,n||V(this,t,r,e,Math.pow(2,8*e)-1,0);var o=1,i=0;for(this[r]=255&t;++i<e&&(o*=256);)this[r+i]=t/o&255;return r+e},v.prototype.writeUIntBE=function(t,r,e,n){t=+t,r|=0,e|=0,n||V(this,t,r,e,Math.pow(2,8*e)-1,0);var o=e-1,i=1;for(this[r+o]=255&t;--o>=0&&(i*=256);)this[r+o]=t/i&255;return r+e},v.prototype.writeUInt8=function(t,r,e){return t=+t,r|=0,e||V(this,t,r,1,255,0),v.TYPED_ARRAY_SUPPORT||(t=Math.floor(t)),this[r]=255&t,r+1},v.prototype.writeUInt16LE=function(t,r,e){return t=+t,r|=0,e||V(this,t,r,2,65535,0),v.TYPED_ARRAY_SUPPORT?(this[r]=255&t,this[r+1]=t>>>8):H(this,t,r,!0),r+2},v.prototype.writeUInt16BE=function(t,r,e){return t=+t,r|=0,e||V(this,t,r,2,65535,0),v.TYPED_ARRAY_SUPPORT?(this[r]=t>>>8,this[r+1]=255&t):H(this,t,r,!1),r+2},v.prototype.writeUInt32LE=function(t,r,e){return t=+t,r|=0,e||V(this,t,r,4,4294967295,0),v.TYPED_ARRAY_SUPPORT?(this[r+3]=t>>>24,this[r+2]=t>>>16,this[r+1]=t>>>8,this[r]=255&t):J(this,t,r,!0),r+4},v.prototype.writeUInt32BE=function(t,r,e){return t=+t,r|=0,e||V(this,t,r,4,4294967295,0),v.TYPED_ARRAY_SUPPORT?(this[r]=t>>>24,this[r+1]=t>>>16,this[r+2]=t>>>8,this[r+3]=255&t):J(this,t,r,!1),r+4},v.prototype.writeIntLE=function(t,r,e,n){if(t=+t,r|=0,!n){var o=Math.pow(2,8*e-1);V(this,t,r,e,o-1,-o)}var i=0,s=1,h=0;for(this[r]=255&t;++i<e&&(s*=256);)t<0&&0===h&&0!==this[r+i-1]&&(h=1),this[r+i]=(t/s>>0)-h&255;return r+e},v.prototype.writeIntBE=function(t,r,e,n){if(t=+t,r|=0,!n){var o=Math.pow(2,8*e-1);V(this,t,r,e,o-1,-o)}var i=e-1,s=1,h=0;for(this[r+i]=255&t;--i>=0&&(s*=256);)t<0&&0===h&&0!==this[r+i+1]&&(h=1),this[r+i]=(t/s>>0)-h&255;return r+e},v.prototype.writeInt8=function(t,r,e){return t=+t,r|=0,e||V(this,t,r,1,127,-128),v.TYPED_ARRAY_SUPPORT||(t=Math.floor(t)),t<0&&(t=255+t+1),this[r]=255&t,r+1},v.prototype.writeInt16LE=function(t,r,e){return t=+t,r|=0,e||V(this,t,r,2,32767,-32768),v.TYPED_ARRAY_SUPPORT?(this[r]=255&t,this[r+1]=t>>>8):H(this,t,r,!0),r+2},v.prototype.writeInt16BE=function(t,r,e){return t=+t,r|=0,e||V(this,t,r,2,32767,-32768),v.TYPED_ARRAY_SUPPORT?(this[r]=t>>>8,this[r+1]=255&t):H(this,t,r,!1),r+2},v.prototype.writeInt32LE=function(t,r,e){return t=+t,r|=0,e||V(this,t,r,4,2147483647,-2147483648),v.TYPED_ARRAY_SUPPORT?(this[r]=255&t,this[r+1]=t>>>8,this[r+2]=t>>>16,this[r+3]=t>>>24):J(this,t,r,!0),r+4},v.prototype.writeInt32BE=function(t,r,e){return t=+t,r|=0,e||V(this,t,r,4,2147483647,-2147483648),t<0&&(t=4294967295+t+1),v.TYPED_ARRAY_SUPPORT?(this[r]=t>>>24,this[r+1]=t>>>16,this[r+2]=t>>>8,this[r+3]=255&t):J(this,t,r,!1),r+4},v.prototype.writeFloatLE=function(t,r,e){return Q(this,t,r,!0,e)},v.prototype.writeFloatBE=function(t,r,e){return Q(this,t,r,!1,e)},v.prototype.writeDoubleLE=function(t,r,e){return W(this,t,r,!0,e)},v.prototype.writeDoubleBE=function(t,r,e){return W(this,t,r,!1,e)},v.prototype.copy=function(t,r,e,n){if(e||(e=0),n||0===n||(n=this.length),r>=t.length&&(r=t.length),r||(r=0),n>0&&n<e&&(n=e),n===e)return 0;if(0===t.length||0===this.length)return 0;if(r<0)throw new RangeError("targetStart out of bounds");if(e<0||e>=this.length)throw new RangeError("sourceStart out of bounds");if(n<0)throw new RangeError("sourceEnd out of bounds");n>this.length&&(n=this.length),t.length-r<n-e&&(n=t.length-r+e);var o,i=n-e;if(this===t&&e<r&&r<n)for(o=i-1;o>=0;--o)t[o+r]=this[o+e];else if(i<1e3||!v.TYPED_ARRAY_SUPPORT)for(o=0;o<i;++o)t[o+r]=this[o+e];else Uint8Array.prototype.set.call(t,this.subarray(e,e+i),r);return i},v.prototype.fill=function(t,r,e,n){if("string"==typeof t){if("string"==typeof r?(n=r,r=0,e=this.length):"string"==typeof e&&(n=e,e=this.length),1===t.length){var o=t.charCodeAt(0);o<256&&(t=o)}if(void 0!==n&&"string"!=typeof n)throw new TypeError("encoding must be a string");if("string"==typeof n&&!v.isEncoding(n))throw new TypeError("Unknown encoding: "+n)}else"number"==typeof t&&(t&=255);if(r<0||this.length<r||this.length<e)throw new RangeError("Out of range index");if(e<=r)return this;r>>>=0,e=void 0===e?this.length:e>>>0,t||(t=0);var i;if("number"==typeof t)for(i=r;i<e;++i)this[i]=t;else{var s=T(t)?t:et(new v(t,n).toString()),h=s.length;for(i=0;i<e-r;++i)this[i+r]=s[i%h]}return this};var Vt=/[^+\/0-9A-Za-z-_]/g;"function"==typeof kt.setTimeout&&setTimeout,"function"==typeof kt.clearTimeout&&clearTimeout;kt.performance;Object.create;var Ht=Array.isArray||function(t){return"[object Array]"===Object.prototype.toString.call(t)},Jt=Object.keys||function(t){var r=[];for(var e in t)Object.prototype.hasOwnProperty.call(t,e)&&r.push(e);return r},Gt={parse:bt,resolve:function(t,r){return bt(t,!1,!0).resolve(r)},resolveObject:function(t,r){return t?bt(t,!1,!0).resolveObject(r):r},format:function(t){return lt(t)&&(t=At({},t)),Et(t)},Url:wt};kt.Url=Gt;var Qt=/^([a-z0-9.+-]+:)/i,Wt=/:[0-9]*$/,Xt=/^(\/\/?(?!\/)[^\?\s]*)(\?[^\s]*)?$/,tr=["<",">",'"',"`"," ","\r","\n","\t"],rr=["{","}","|","\\","^","`"].concat(tr),er=["'"].concat(rr),nr=["%","/","?",";","#"].concat(er),or=["/","?","#"],ir=255,sr=/^[+a-z0-9A-Z_-]{0,63}$/,hr=/^([+a-z0-9A-Z_-]{0,63})(.*)$/,ar={javascript:!0,"javascript:":!0},ur={javascript:!0,"javascript:":!0},fr={http:!0,https:!0,ftp:!0,gopher:!0,file:!0,"http:":!0,"https:":!0,"ftp:":!0,"gopher:":!0,"file:":!0};wt.prototype.parse=function(t,r,e){return At(this,t,r,e)},wt.prototype.format=function(){return Et(this)},wt.prototype.resolve=function(t){return this.resolveObject(bt(t,!1,!0)).format()},wt.prototype.resolveObject=function(t){if(lt(t)){var r=new wt;r.parse(t,!1,!0),t=r}for(var e=new wt,n=Object.keys(this),o=0;o<n.length;o++){var i=n[o];e[i]=this[i]}if(e.hash=t.hash,""===t.href)return e.href=e.format(),e;if(t.slashes&&!t.protocol){for(var s=Object.keys(t),h=0;h<s.length;h++){var a=s[h];"protocol"!==a&&(e[a]=t[a])}return fr[e.protocol]&&e.hostname&&!e.pathname&&(e.path=e.pathname="/"),e.href=e.format(),e}var u;if(t.protocol&&t.protocol!==e.protocol){if(!fr[t.protocol]){for(var f=Object.keys(t),c=0;c<f.length;c++){var l=f[c];e[l]=t[l]}return e.href=e.format(),e}if(e.protocol=t.protocol,t.host||ur[t.protocol])e.pathname=t.pathname;else{for(u=(t.pathname||"").split("/");u.length&&!(t.host=u.shift()););t.host||(t.host=""),t.hostname||(t.hostname=""),""!==u[0]&&u.unshift(""),u.length<2&&u.unshift(""),e.pathname=u.join("/")}if(e.search=t.search,e.query=t.query,e.host=t.host||"",e.auth=t.auth,e.hostname=t.hostname||t.host,e.port=t.port,e.pathname||e.search){var p=e.pathname||"",g=e.search||"";e.path=p+g}return e.slashes=e.slashes||t.slashes,e.href=e.format(),e}var y=e.pathname&&"/"===e.pathname.charAt(0),m=t.host||t.pathname&&"/"===t.pathname.charAt(0),v=m||y||e.host&&t.pathname,d=v,w=e.pathname&&e.pathname.split("/")||[],b=e.protocol&&!fr[e.protocol];u=t.pathname&&t.pathname.split("/")||[],b&&(e.hostname="",e.port=null,e.host&&(""===w[0]?w[0]=e.host:w.unshift(e.host)),e.host="",t.protocol&&(t.hostname=null,t.port=null,t.host&&(""===u[0]?u[0]=t.host:u.unshift(t.host)),t.host=null),v=v&&(""===u[0]||""===w[0]));var A;if(m)e.host=t.host||""===t.host?t.host:e.host,e.hostname=t.hostname||""===t.hostname?t.hostname:e.hostname,e.search=t.search,e.query=t.query,w=u;else if(u.length)w||(w=[]),w.pop(),w=w.concat(u),e.search=t.search,e.query=t.query;else if(!ct(t.search))return b&&(e.hostname=e.host=w.shift(),(A=!!(e.host&&e.host.indexOf("@")>0)&&e.host.split("@"))&&(e.auth=A.shift(),e.host=e.hostname=A.shift())),e.search=t.search,e.query=t.query,ft(e.pathname)&&ft(e.search)||(e.path=(e.pathname?e.pathname:"")+(e.search?e.search:"")),e.href=e.format(),e;if(!w.length)return e.pathname=null,e.search?e.path="/"+e.search:e.path=null,e.href=e.format(),e;for(var E=w.slice(-1)[0],R=(e.host||t.host||w.length>1)&&("."===E||".."===E)||""===E,_=0,P=w.length;P>=0;P--)"."===(E=w[P])?w.splice(P,1):".."===E?(w.splice(P,1),_++):_&&(w.splice(P,1),_--);if(!v&&!d)for(;_--;_)w.unshift("..");!v||""===w[0]||w[0]&&"/"===w[0].charAt(0)||w.unshift(""),R&&"/"!==w.join("/").substr(-1)&&w.push("");var U=""===w[0]||w[0]&&"/"===w[0].charAt(0);return b&&(e.hostname=e.host=U?"":w.length?w.shift():"",(A=!!(e.host&&e.host.indexOf("@")>0)&&e.host.split("@"))&&(e.auth=A.shift(),e.host=e.hostname=A.shift())),(v=v||e.host&&w.length)&&!U&&w.unshift(""),w.length?e.pathname=w.join("/"):(e.pathname=null,e.path=null),ft(e.pathname)&&ft(e.search)||(e.path=(e.pathname?e.pathname:"")+(e.search?e.search:"")),e.auth=t.auth||e.auth,e.slashes=e.slashes||t.slashes,e.href=e.format(),e},wt.prototype.parseHost=function(){return Rt(this)}}();
!function(){"use strict";var e={_logger:window.Rollbar||null,deprecatedModule:function(e){this.info("Deprecated module: "+e,{module:e})},deprecatedFunction:function(e){this.info("Deprecated function: "+e,{func:e})},info:function(e,t){null!==this._logger&&this._logger.info(e,t)}};function t(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t);if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e,"string");return"symbol"==typeof t?t:String(t)}function r(e){return r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r(e)}function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function s(e,r){for(var n=0;n<r.length;n++){var s=r[n];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,t(s.key),s)}}function o(e,t,r){return t&&s(e.prototype,t),r&&s(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&u(e,t)}function a(e){return a=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},a(e)}function u(e,t){return u=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},u(e,t)}function c(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function l(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,s,o,i,a=[],u=!0,c=!1;try{if(o=(r=r.call(e)).next,0===t);else for(;!(u=(n=o.call(r)).done)&&(a.push(n.value),a.length!==t);u=!0);}catch(e){c=!0,s=e}finally{try{if(!u&&null!=r.return&&(i=r.return(),Object(i)!==i))return}finally{if(c)throw s}}return a}}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return f(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return f(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function f(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var h=function(e){var t=e;return t.getStatusText=function(){switch(this.status){case 100:return"Continue";case 101:return"Switching Protocols";case 200:return"Ok";case 201:return"Created";case 202:return"Accepted";case 203:return"Non-Authoritative Information";case 204:return"No Content";case 205:return"Reset Content";case 206:return"Partial Content";case 207:return"Multi-Status";case 300:return"Multiple Choices";case 301:return"Moved Permanently";case 302:return"Found";case 303:return"See Other";case 304:return"Not Modified";case 305:return"Use Proxy";case 306:return"(Reserved)";case 307:return"Temporary Redirect";case 400:return"Bad Request";case 401:return"Unauthorized";case 402:return"Payment Required";case 403:return"Forbidden";case 404:return"Not Found";case 405:return"Method Not Allowed";case 406:return"Not Acceptable";case 407:return"Proxy Authentication";case 408:return"Request Timeout";case 409:return"Conflict";case 410:return"Gone";case 411:return"Length Required";case 412:return"Precondition Failed";case 413:return"Request Entity Too Large";case 414:return"Request-URI Too Long";case 415:return"Unsupported Media Type";case 416:return"Requested Range Not Satisfiable";case 417:return"Expectation Failed";case 422:return"Unprocessable Entity";case 423:return"Locked";case 424:return"Failed Dependency";case 500:return"Internal Server Error";case 501:return"Not Implemented";case 502:return"Bad Gateway";case 503:return"Service Unavailable";case 504:return"Gateway Timeout";case 505:return"HTTP Version Not Supported";case 507:return"Insufficient Storage"}return"(Unknown)"},t.isSuccess=function(){return this.status>=200&&this.status<300||304===this.status},t.getETag=function(){var e=this.getResponseHeader("ETag"),t=this.getResponseHeader("Content-Encoding");return t&&t.length>0&&(e=e.replace("-"+t,"")),e},t.errorMessage=function(e){return(e||"Request failed")+" (status: "+this.status+" - "+this.getStatusText()+")"},t.getError=function(){if(this.isSuccess())throw new Error("The response was successful, requesting an error in not a valid operation");var e=this.isJson()?this.getJson():{};return{code:this.status,exception:e.exception||null,message:e.message||this.errorMessage(),data:e.data||e}},t.isJson=function(){var e="application/json";return(this.getResponseHeader("Content-Type")||"").substr(0,16)===e},t.getJson=function(){if(!this.isJson())throw new Error("Response is not JSON (Content-Type: "+this.getResponseHeader("Content-Type")+")");return JSON.parse(this.responseText)},t},p={},g={},d=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"global-settings";if(!(e in p)||!0!==p[e]){var t="#mt-".concat(e),r=document.querySelector(t);if(r){var n=r.textContent;n&&""!==n||(n=r.text);var s=JSON.parse(n);Object.keys(s).forEach((function(e){g[e]=s[e]})),p[e]=!0}}},m=function(e){return g[e]},v=function(e,t){g[e]=t};d();try{var y=m("sessionSettings");null!==y&&"object"===r(y)&&window.sessionStorage.setItem("sessionSettings",JSON.stringify(y));var w=window.sessionStorage.getItem("sessionSettings");w&&null!==(y=JSON.parse(w))&&"object"===r(y)&&Object.keys(y).forEach((function(e){v(e,y[e])}))}catch(e){}var _=/^(?:(?![^:@]+:[^:@\/]*@)([^:\/?#.]+):)?(?:\/\/)?((?:(([^:@]*)(?::([^:@]*))(?:[^\/@]*)?)?@)?([^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(#.*)?)/,k=["original","protocol","authority","userInfo","user","password","hostname","port","relative","path","directory","file","query","fragment"],P=function(){function e(t,r){if(n(this,e),!t)throw new Error("missing url argument");r=r||{},this.headers=r.headers||{},this.suppressOriginParam=!0===r.suppressOriginParam,$.extend(this,"string"==typeof t?function(e){if(!e)return{original:"",protocol:null,authority:null,userInfo:null,user:null,password:null,hostname:null,port:null,relative:null,path:null,directory:null,file:null,query:null,params:null,fragment:null,segments:[]};for(var t=_.exec(e),r={},n=0;n<k.length;++n)r[k[n]]=t[n]||null;if(r.fragment=null===r.fragment?null:decodeURIComponent(r.fragment.substr(1)),r.trailingSlash=!!r.path&&"/"===r.path[r.path.length-1],r.params=e.indexOf("?")<0?null:function(){var e={};if(null!==r.query)for(var t=r.query.split("&"),n=0;n<t.length;++n)if(t[n]){var s=t[n].split("=");e[s[0]]=s.length>1?decodeURIComponent(s[1]):null}return e}(),r.segments=function(){var e=r.path.replace(/^\//,"").replace(/\/$/,"").split("/");if(1===e.length&&0===e[0].length)e=[];else for(var t=0;t<e.length;++t)e[t]=decodeURIComponent(e[t]);return e}(),r.protocol=r.protocol||null,r.hostname=r.protocol?r.hostname||"":null,r.implicitPort=null===r.port,r.implicitPort&&r.protocol){switch(r.protocol){case"http":r.port="80";break;case"https":r.port="443";break;case"ftp":r.port="21";break;case"file":r.port=null;break;default:r.port=0}var s=r.protocol+"://"+r.hostname+":";r.implicitPort=e.substr(0,s.length)!==s}return r}(t):t,r)}return o(e,[{key:"getUrl",value:function(){var e="";this.protocol&&(e+=this.protocol+"://"+this.hostname),!this.implicitPort&&this.port&&(e+=":"+this.port);for(var t=0;t<this.segments.length;++t)e+="/"+encodeURIComponent(this.segments[t]);if(this.trailingSlash&&(e+="/"),this.params){e+="?";var r=!0;$.each(this.params,(function(t,n){r||(e+="&"),r=!1,e+=encodeURIComponent(t),null!==n&&(e+="="+encodeURIComponent(n.toString()))}))}return null!==this.fragment&&(e+="#"+encodeURIComponent(this.fragment)),e}},{key:"get",value:function(e,t,r){var n=null!==e,s={context:this,async:n,url:this.getUrl(),type:t||"GET",cache:!1,beforeSend:this._beforeSend,complete:n&&function(t){e(h(t))}};r&&Object.keys(r).forEach((function(e){s[e]=r[e]}));var o=$.ajax(s);if(!n)return h(o)}},{key:"post",value:function(e,t,r,n){var s=null!==r,o={context:this,async:s,url:this.getUrl(),type:"POST",data:e||"",contentType:t,processData:!1,beforeSend:this._beforeSend,complete:s&&function(e){r(h(e))}};n&&Object.keys(n).forEach((function(e){o[e]=n[e]}));var i=$.ajax(o);if(!s)return h(i)}},{key:"put",value:function(e,t,r){return this.withHeader("X-HTTP-Method-Override","PUT").post(e,t,r)}},{key:"head",value:function(e){return this.get(e,"HEAD")}},{key:"options",value:function(e){return this.get(e,"OPTIONS")}},{key:"del",value:function(e){return this.withHeader("X-HTTP-Method-Override","DELETE").post(null,null,e)}},{key:"at",value:function(){for(var t=new Array(arguments.length),r=0;r<t.length;++r){if(!arguments[r])throw new Error("argument "+(r+1)+" is null");t[r]=arguments[r]}var n=[];return this.segments.forEach((function(e){n.push(e.toString())})),t.forEach((function(e){Array.isArray(e)?e.forEach((function(e){n.push(e.toString())})):n.push(e.toString())})),new e(this,$.extend({},this.options,{segments:n,trailingSlash:!1}))}},{key:"withParam",value:function(t,r){var n=$.extend({},this.params);return n[t]=r,new e(this,$.extend({},this.options,{params:n}))}},{key:"withParams",value:function(t){var r=$.extend({},this.params,t);return new e(this,$.extend({},this.options,{params:r}))}},{key:"withoutParam",value:function(t){var r=$.extend({},this.params);return delete r[t],new e(this,$.extend({},this.options,{params:r}))}},{key:"withTrailingSlash",value:function(){return new e(this,$.extend({},this.options,{trailingSlash:!0}))}},{key:"withoutTrailingSlash",value:function(){return new e(this,$.extend({},this.options,{trailingSlash:!0}))}},{key:"withHeader",value:function(t,r){var n=$.extend({},this.headers);return n[t]=r,new e(this,$.extend({},this.options,{headers:n}))}},{key:"withHeaders",value:function(t){var r=$.extend({},this.headers,t);return new e(this,$.extend({},this.options,{headers:r}))}},{key:"withoutHeader",value:function(t){var r=$.extend({},this.headers);return delete r[t],new e(this,$.extend({},this.options,{headers:r}))}},{key:"_beforeSend",value:function(e){this.headers&&$.each(this.headers,(function(t,n){"object"!==r(n)&&"function"!=typeof n&&e.setRequestHeader(t,n)}));var t=m("apiToken");return t&&this.segments.length&&"@api"===this.segments[0]&&e.setRequestHeader("X-Deki-Token",t),e.setRequestHeader("X-Deki-Client","mindtouch-web-javascript"),!0}}]),e}(),S={"<":"&lt;",">":"&gt;",'"':"&quot;","&":"&amp;","'":"&#39;"},b=Object.entries(S).reduce((function(e,t){var r=l(t,2),n=r[0];return e[r[1]]=n,e}),{}),x=new RegExp("[".concat(Object.keys(S).join(""),"]"),"g");function T(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"\\s";return e.replace(new RegExp("^".concat(t,"+")),"")}new RegExp("".concat(Object.keys(b).map((function(e){return"(".concat(e,")")})).join("|")),"g");var R=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:window.location.origin;n(this,e),"string"==typeof t&&(t=t.replace(/\\/g,"%5C")),"string"==typeof r&&(r=r.replace(/\\/g,"%5C")),this._url=new URL(t,r)}return o(e,null,[{key:"tryParse",value:function(t){var r;try{r=new URL(t)}catch(e){return null}return new e(r.href)}}]),o(e,[{key:"toString",value:function(){return this._url.toString()}},{key:"getQueryParam",value:function(e){return this._url.searchParams.get(e)}},{key:"removeQueryParam",value:function(e){return this._url.searchParams.delete(e),this}},{key:"addQueryParam",value:function(e,t){var r=null==t?"":t;return this._url.searchParams.append(e,r),this}},{key:"addQueryParams",value:function(e){var t=this;return Object.entries(e).forEach((function(e){var r=l(e,2),n=r[0],s=r[1];t.addQueryParam(n,s)})),this}},{key:"setQueryParam",value:function(e,t){return this.removeQueryParam(e),this.addQueryParam(e,t),this}},{key:"setQueryParams",value:function(e){var t=this;return Object.entries(e).forEach((function(e){var r=l(e,2),n=r[0],s=r[1];t.setQueryParam(n,s)})),this}},{key:"addSegments",value:function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];var n=function e(t){return t.reduce((function(t,r){return Array.isArray(r)?t+=e(r):("/"===r[0]&&(r=r.slice(1)),t+="/".concat(r)),t}),"")}(t),s=this._url.pathname;return"/"===s&&(s=""),this._url.pathname="".concat(s).concat(n),this}},{key:"hash",get:function(){return this._url.hash},set:function(e){this._url.hash=e}},{key:"host",get:function(){return this._url.host},set:function(e){this._url.host=e}},{key:"hostname",get:function(){return this._url.hostname},set:function(e){this._url.hostname=e}},{key:"href",get:function(){return this._url.href},set:function(e){this._url.href=e}},{key:"password",get:function(){return this._url.password},set:function(e){this._url.password=e}},{key:"pathname",get:function(){return this._url.pathname},set:function(e){this._url.pathname=e}},{key:"port",get:function(){return this._url.port},set:function(e){this._url.port=e}},{key:"protocol",get:function(){return this._url.protocol},set:function(e){this._url.protocol=e}},{key:"search",get:function(){return this._url.search},set:function(e){this._url.search=e}},{key:"username",get:function(){return this._url.username},set:function(e){this._url.username=e}},{key:"origin",get:function(){return this._url.origin}},{key:"searchParams",get:function(){return this._url.searchParams}}]),e}(),j={},C={_restrictedPasswordWords:["password"],getProtocol:function(){return window.location.protocol.replace(":","")},getOrigin:function(e){var t=window.location;return e&&((t=document.createElement("a")).href=e),t.origin||t.protocol+"//"+t.hostname+(t.port?":"+t.port:"")},xmlRequestType:"application/xml; charset=utf-8",textRequestType:"text/plain; charset=utf-8",jsonRequestType:"application/json; charset=utf-8",formRequestType:"application/x-www-form-urlencoded",strToBool:function(e){return!0===e||"string"==typeof e&&"true"===e.trim().toLowerCase()},formatNumber:function(e,t,r){t=t||".",r=r||",";for(var n=(e=String(e)).split("."),s=n[0],o=n.length>1?t+n[1]:"",i=/(\d+)(\d{3})/;i.test(s);)s=s.replace(i,"$1"+r+"$2");return s+o},formatPageContentViewUri:function(e){var t=new R(e),r=m("pageContentViewParser");return r&&t.setQueryParam("mt-view",r),t.toString()},formatBytes:function(e){var t=0;switch(e>1228&&(t+=1,e/=1024),e>1228&&(t+=1,e/=1024),e>1228&&(t+=1,e/=1024),t){case 0:default:return this.formatNumber(Math.round(e))+" bytes";case 1:return this.formatNumber(Math.round(e))+" KiB";case 2:return this.formatNumber(Math.round(10*e)/10)+" MiB";case 3:return this.formatNumber(Math.round(100*e)/100)+" GiB"}},pad:function(e){return(e<10?"0":"")+e},compareDate:function(e,t,r){var n=new Date(e),s=new Date(t),o=!1;if(!window.isNaN(n)&&!window.isNaN(s))switch(r){case"day":o=n.getDate()===s.getDate()&&n.getMonth()===s.getMonth()&&n.getFullYear()===s.getFullYear();break;case"month":o=n.getFullYear()===s.getFullYear()&&n.getMonth()===s.getMonth();break;case"year":o=n.getFullYear()===s.getFullYear();break;default:o=n.toString()===s.toString()}return o},formatLocalization:function(e){if(e){e=C.getLoc(e);for(var t=0;t<arguments.length;t++){var r=new RegExp("\\{"+t+"\\}","g");e=e.replace(r,arguments[t+1])}return e}},getLoc:function(e){return j[e]||e},setLoc:function(e){var t;for(t in e)e.hasOwnProperty(t)&&(j[t]=e[t])},store:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"local";try{var n=JSON.stringify(t);return void 0!==n&&("session"===r?window.sessionStorage.setItem(e,n):window.localStorage.setItem(e,n),!0)}catch(e){return!1}},fetch:function(e){var t,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"local",n=null;try{(t="session"===r?window.sessionStorage.getItem(e):window.localStorage.getItem(e))&&(n=JSON.parse(t))}catch(e){return null}return n},clearStorage:function(e){if("session"!==(arguments.length>1&&void 0!==arguments[1]?arguments[1]:"local"))try{window.localStorage.removeItem(e)}catch(e){}else window.sessionStorage.removeItem(e)},readCookie:function(e){for(var t=e+"=",r=document.cookie.split(";"),n=0;n<r.length;n++){var s=T(r[n]);if(0===s.indexOf(t))return s.substring(t.length,s.length)}return null},createCookie:function(e,t,r){var n="";if(r){var s=new Date;s.setTime(s.getTime()+24*r*60*60*1e3),n="; expires="+s.toGMTString()}document.cookie=e+"="+t+n+"; path=/"},isValidEmail:function(e){return new RegExp("^[A-Za-z0-9._%+-]+@[A-Za-z0-9.-]+\\.[A-Za-z]{2,4}$").test(e)},searchEscape:function(e){var t=e.toString();return["\\","+","-","&","|","!","(",")","{","}","[","]","^",'"',"~","*","?",":"].forEach((function(e){var r=new RegExp("\\"+e,"g");t=t.replace(r,"\\"+e)})),t},getPasswordStrength:function(e){var t={rating:!0,lengthOk:!0,matchVerify:!0,freeOfRestrictedWords:!0};e.password.length<e.minLength&&(t.lengthOk=!1),e.matchPassword.length>0&&e.matchPassword!==e.password&&(t.matchVerify=!1);var r=0;e.password.match(/[a-z]+/)&&r++,e.password.match(/[A-Z]+/)&&r++,e.password.match(/[0-9]+/)&&r++,e.password.match(/\W+/)&&r++,r<e.minRating&&(t.rating=!1);var n=e.password.toLowerCase(),s=!1;return this._restrictedPasswordWords.forEach((function(e){s=s||n.includes(e)})),s&&(t.freeOfRestrictedWords=!1),t.allOk=t.rating&&t.lengthOk&&t.matchVerify&&t.freeOfRestrictedWords,t},makeArray:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return Array.isArray(e)?e:[e]},makeString:function(e){if("string"==typeof e)return e;if(e instanceof Object&&"#text"in e)return e["#text"];throw new Error("No string or string-containing object found")},importModule:function(e){var t,r=e.path,n=e.moduleName,s=void 0===n?null:n,o=e.exportNamespace,i=void 0===o?"Deki._mtLib":o;if("global"===m("moduleMode")){"noModule"in document.createElement("script")&&(r=r.replace(/\.js/,".modern.js"));var a=i.split(".").reduce((function(e,t){return e[t]=e[t]||{},e[t]}),window);if(void 0!==a[s])return Promise.resolve(a[s]);t=C.getCachedJavascript(r.replace("/@lib/src/","/deki/javascript/out/")).then((function(){return a[s]}))}return t},importExternalModule:function(e){var t=e.libVar,r=void 0===t?null:t,n=e.globalPath;return null!==r?Promise.resolve():C.getCachedJavascript(n)},getCachedJavascript:function(e){var t=this;return new Promise((function(r){var n=document.createElement("script");n.src=t.getCacheUrl(e),n.onload=function(){document.head.removeChild(n),r()},n.onerror=function(){document.head.removeChild(n)},document.head.appendChild(n)}))},translateModulePath:function(e){return"module"!==m("moduleMode")&&(e=e.replace("/@lib/src/","/deki/javascript/out/")),e},getCacheUrl:function(e){if(m("cdnHostname")){var t=m("cacheFingerprint");return t?window.location.protocol+"//"+m("cdnHostname")+e+"?_="+t:e}return e},finishDeferred:function(e){return function(t){var r=!1;"success"in t&&(r=t.success,delete t.success),r?e.resolve(t):e.reject(t)}},getStringParams:function(e){var t,r,n={},s=(t=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",r=""===t?-1:e.indexOf(t);return-1===r?e:e.slice(r+t.length,e.length)}(e,"?"),r="&",""===t?[]:t.trim().split(r));return s.forEach((function(e){var t=e.split("=");t[0]&&(n[decodeURIComponent(t[0])]=decodeURIComponent(t[1]))})),n},buildQueryString:function(e){var t="";return Object.keys(e).forEach((function(r){var n="".concat(encodeURIComponent(r),"=").concat(encodeURIComponent(e[r]));t="".concat(t).concat(""!==t?"&":"").concat(n)})),t},guid:function(){function e(e){var t=(Math.random().toString(16)+"000000000").substr(2,8);return e?"-"+t.substr(0,4)+"-"+t.substr(4,4):t}return e()+e(!0)+e(!0)+e()},htmlCleanString:function(){var e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"").replace(/\s/g,"-");return e=e.replace(/[^A-Za-z0-9-]/g,"")},extendObject:function(e,t){var r={};return Object.keys(e).forEach((function(t){r[t]=e[t]})),Object.keys(t).forEach((function(e){r[e]=t[e]})),r},findInArray:function(e,t){for(var r=null,n=0;n<e.length;n++){var s=e[n];if(t(s)){r=s;break}}return r},getPagesWithClassifications:function(e,t){if(!e)return[];var r=[];return e.forEach((function(e){e.tags||(e.tags=[]);var n=e;n.classifications={},t.forEach((function(t){var r=e.tags.find((function(e){return e.value.startsWith(t.prefix+":")}));if(r&&t.tags){var s=t.tags.find((function(e){return"".concat(t.prefix,":").concat(e.tag)===r.title}));s&&(n.classifications[t.prefix]=s)}})),r.push(n)})),r},ancestorEscape:function(e){var t=this.searchEscape(e);return["#","<",">"].forEach((function(e){var r=new RegExp(e,"g");t=t.replace(r,encodeURIComponent(e))})),t},canCopyToClipboard:function(){return document.queryCommandSupported&&document.queryCommandSupported("copy")},copyTextToClipboard:function(e){var t=e instanceof Element?e:document.querySelector(e),r=window.getSelection(),n=document.createRange();n.selectNodeContents(t),r.removeAllRanges(),r.addRange(n);var s=document.execCommand("copy");return r.removeAllRanges(),s},cleanParams:function(e){return Object.keys(e).forEach((function(t){null!==e[t]&&void 0!==e[t]&&""!==e[t].trim()||delete e[t]})),e},parseJwt:function(e){try{var t=e.split(".")[1].replace(/-/g,"+").replace(/_/g,"/"),r=decodeURIComponent(atob(t).split("").map((function(e){return"%"+("00"+e.charCodeAt(0).toString(16)).slice(-2)})).join(""));return JSON.parse(r)}catch(e){return null}}},E=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";n(this,e),"string"!=typeof t&&(t=""),t.startsWith("#")&&(t=t.substr(1)),this._hashStr=t,this._params=C.getStringParams(t)}return o(e,[{key:"getQueryParams",value:function(){return this._params}},{key:"replaceParams",value:function(t){return new e(C.buildQueryString(t))}},{key:"withParam",value:function(e,t){var r=this._params;return r[e]=t,this.replaceParams(r)}},{key:"withoutParam",value:function(e){var t=this._params;return delete t[e],this.replaceParams(t)}},{key:"getParam",value:function(e){return this._params[e]}},{key:"toHashString",value:function(){return"#"+this._hashStr}}]),e}(),O=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";n(this,e),this.parsedUrl=Url.parse(t,!0),this.parsedUrl.search=null}return o(e,[{key:"path",value:function(){return this.parsedUrl.pathname}},{key:"getSegments",value:function(){var e=this.path();return e.startsWith("/")&&(e=T(e,"/")),e.split("/")}},{key:"query",value:function(){return Url.parse(this.toString()).search||""}},{key:"origin",value:function(){var e=this.parsedUrl;return"".concat(e.protocol,"//").concat(e.host)}},{key:"getHostName",value:function(){return this.parsedUrl.hostname}},{key:"getUriHash",value:function(){return new E(this.parsedUrl.hash)}},{key:"getProtocol",value:function(){return this.parsedUrl.protocol}},{key:"addQueryParam",value:function(e,t){return this.withParam(e,t)}},{key:"addQueryParams",value:function(e){return this.withParams(e)}},{key:"removeQueryParam",value:function(e){return e in this.parsedUrl.query&&delete this.parsedUrl.query[e],this}},{key:"getQueryParamValue",value:function(e){var t=this.parsedUrl.query;return e in t?t[e]:null}},{key:"withHost",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";if(""===e.trim())return this;var t=Url.parse(e);return this.parsedUrl.host=t.host,this.parsedUrl.hostname=t.hostname,this.parsedUrl.protocol=t.protocol,this}},{key:"withParam",value:function(e,t){return this.parsedUrl.query[e]=t,this}},{key:"withParams",value:function(e){var t=this;return Object.keys(e).forEach((function(r){t.addQueryParam(r,e[r])})),this}},{key:"addSegments",value:function(){for(var e="",t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];r.forEach((function(t){Array.isArray(t)?t.forEach((function(t){t=T(t,"/"),e="".concat(e,"/").concat(t)})):(t=T(t,"/"),e="".concat(e,"/").concat(t))}));var s=this.parsedUrl.pathname||"";return this.parsedUrl.pathname="".concat(s).concat(e),this.parsedUrl=Url.parse(this.parsedUrl),this}},{key:"toString",value:function(){return Url.format(this.parsedUrl)}},{key:"toCanonicalUri",value:function(){return this.removeQueryParam("mt-view"),this}}]),e}(),U="undefined"==typeof window?"node":"browser",D={get environment(){return U},base64:{encode:function(e){return"node"===U?new Buffer(e).toString("base64"):window.btoa(e)},decode:function(e){return"node"===U?new Buffer(e,"base64").toString("utf8"):window.atob(e)}},get URL(){return"browser"===U?window.URL:require("url").URL},get URLSearchParams(){return"browser"===U?window.URLSearchParams:require("url").URLSearchParams},get defaultHost(){return"browser"===U?window.location.origin:global.__DefaultMindTouchHost||""}};function A(e){if(!e.headers.has("location"))return!1;var t=e.status;return 301===t||302===t||303===t||307===t||308===t}function q(e){var t=this;return new Promise((function(r,n){var s=A(e);s&&t._followRedirects&&null!==t._cookieManager?r(e):!s||t._followRedirects?e.ok||304===e.status?r(e):e.text().then((function(t){n({message:e.statusText,status:e.status,responseText:t})})):r(e)}))}function I(e){return null!==this._cookieManager?this._cookieManager.getCookieString(e.url).then((function(t){""!==t&&e.headers.set("Cookie",t)})).then((function(){return e})):Promise.resolve(e)}function N(e){if(null!==this._cookieManager){var t=e.headers.get("Set-Cookie");return t=t?t.split(",").map((function(e){return e.trim()})):[],this._cookieManager.storeCookies(e.url,t).then((function(){return e}))}return Promise.resolve(e)}function J(e){var t=this,r=e.url,n=e.method,s=e.headers,o=e.body,i=void 0===o?null:o,a=new Headers(s),u=i,c={method:n,headers:a,credentials:"include",redirect:this._followRedirects&&null===this._cookieManager?"follow":"manual",keepalive:this._keepAlive};null!==i&&(c.body=u);var l=new Request(r,c);return I.call(this,l).then(this._fetch).then(q.bind(this)).then(N.bind(this)).then((function(e){return t._followRedirects&&A(e)?J.call(t,{url:e.headers.get("location"),method:307!==e.status&&308!==e.status?"GET":l.method,headers:a,body:u}):e}))}var M=function(){function e(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},s=r.uriParts,o=void 0===s?{}:s,i=r.headers,a=void 0===i?{}:i,u=r.timeout,c=void 0===u?null:u,l=r.beforeRequest,f=void 0===l?function(e){return e}:l,h=r.cookieManager,p=void 0===h?null:h,g=r.followRedirects,d=void 0===g||g,m=r.keepAlive,v=void 0!==m&&m,y=r.fetchImpl,w=void 0===y?fetch:y;if(n(this,e),!t)throw new Error("A full, valid URL must be specified");try{this._url=new D.URL(t)}catch(e){throw new Error("Unable to construct a URL object from ".concat(t))}"segments"in o&&function(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];var s=function e(t){return t.reduce((function(t,r){return Array.isArray(r)?t+=e(r):("/"===r[0]&&(r=r.slice(1)),t+="/".concat(r)),t}),"")}(r),o=e.pathname;"/"===o&&(o=""),e.pathname="".concat(o).concat(s)}(this._url,o.segments),"query"in o&&function(e,t){"q=+%2B"!==new D.URLSearchParams({q:" +"}).toString()?Object.keys(t).forEach((function(r){var n=t[r].toString().includes(" ")?t[r].split(" ").map(encodeURIComponent).join(" "):t[r];e.searchParams.append(r,n)})):Object.keys(t).forEach((function(r){e.searchParams.append(r,t[r])}))}(this._url,o.query),"excludeQuery"in o&&this._url.searchParams.delete(o.excludeQuery),this._beforeRequest=f,this._timeout=c,this._headers=Object.assign({},a),this._cookieManager=p,this._followRedirects=d,this._keepAlive=v,this._fetch=w}return o(e,[{key:"at",value:function(){for(var e=[],t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return r.forEach((function(t){e.push(t.toString())})),new this.constructor(this._url.toString(),{headers:this._headers,timeout:this._timeout,beforeRequest:this._beforeRequest,uriParts:{segments:e},cookieManager:this._cookieManager,followRedirects:this._followRedirects,keepAlive:this._keepAlive,fetchImpl:this._fetch})}},{key:"withParam",value:function(e,t){var r={};return r[e]=t,new this.constructor(this._url.toString(),{headers:this._headers,timeout:this._timeout,beforeRequest:this._beforeRequest,uriParts:{query:r},cookieManager:this._cookieManager,followRedirects:this._followRedirects,keepAlive:this._keepAlive,fetchImpl:this._fetch})}},{key:"withParams",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return new this.constructor(this._url.toString(),{headers:this._headers,timeout:this._timeout,beforeRequest:this._beforeRequest,uriParts:{query:e},cookieManager:this._cookieManager,followRedirects:this._followRedirects,keepAlive:this._keepAlive,fetchImpl:this._fetch})}},{key:"withoutParam",value:function(e){return new this.constructor(this._url.toString(),{headers:this._headers,timeout:this._timeout,beforeRequest:this._beforeRequest,uriParts:{excludeQuery:e},cookieManager:this._cookieManager,followRedirects:this._followRedirects,keepAlive:this._keepAlive,fetchImpl:this._fetch})}},{key:"withHeader",value:function(e,t){var r=Object.assign({},this._headers);return r[e]=t,new this.constructor(this._url.toString(),{timeout:this._timeout,beforeRequest:this._beforeRequest,headers:r,cookieManager:this._cookieManager,followRedirects:this._followRedirects,keepAlive:this._keepAlive,fetchImpl:this._fetch})}},{key:"withHeaders",value:function(e){var t=Object.assign({},this._headers);return Object.keys(e).forEach((function(r){t[r]=e[r]})),new this.constructor(this._url.toString(),{timeout:this._timeout,beforeRequest:this._beforeRequest,headers:t,cookieManager:this._cookieManager,followRedirects:this._followRedirects,keepAlive:this._keepAlive,fetchImpl:this._fetch})}},{key:"withoutHeader",value:function(e){var t=Object.assign({},this._headers);return delete t[e],new this.constructor(this._url.toString(),{timeout:this._timeout,beforeRequest:this._beforeRequest,headers:t,cookieManager:this._cookieManager,followRedirects:this._followRedirects,keepAlive:this._keepAlive,fetchImpl:this._fetch})}},{key:"withFollowRedirects",value:function(){return new this.constructor(this._url.toString(),{timeout:this._timeout,beforeRequest:this._beforeRequest,headers:this._headers,cookieManager:this._cookieManager,followRedirects:!0,keepAlive:this._keepAlive,fetchImpl:this._fetch})}},{key:"withoutFollowRedirects",value:function(){return new this.constructor(this._url.toString(),{timeout:this._timeout,beforeRequest:this._beforeRequest,headers:this._headers,cookieManager:this._cookieManager,followRedirects:!1,keepAlive:this._keepAlive,fetchImpl:this._fetch})}},{key:"withKeepAlive",value:function(){return new this.constructor(this._url.toString(),{timeout:this._timeout,beforeRequest:this._beforeRequest,headers:this._headers,cookieManager:this._cookieManager,followRedirects:this._followRedirects,keepAlive:!0,fetchImpl:this._fetch})}},{key:"withoutKeepAlive",value:function(){return new this.constructor(this._url.toString(),{timeout:this._timeout,beforeRequest:this._beforeRequest,headers:this._headers,cookieManager:this._cookieManager,followRedirects:this._followRedirects,keepAlive:!1,fetchImpl:this._fetch})}},{key:"get",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"GET",t=this._beforeRequest({url:this._url.toString(),method:e,headers:Object.assign({},this._headers)});return J.call(this,t)}},{key:"post",value:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"POST",n=Object.assign({},this._headers);t&&(n["Content-Type"]=t);var s=this._beforeRequest({url:this._url.toString(),method:r,body:e,headers:n});return J.call(this,s)}},{key:"put",value:function(e,t){return this.post(e,t,"PUT")}},{key:"head",value:function(){return this.get("HEAD")}},{key:"options",value:function(){return this.get("OPTIONS")}},{key:"delete",value:function(){return this.post(null,null,"DELETE")}},{key:"url",get:function(){return this._url.toString()}},{key:"headers",get:function(){return new Headers(this._headers)}},{key:"followingRedirects",get:function(){return this._followRedirects}}]),e}();var H="mt-modal-open",F=function(e){var t=e.scrollHeight;t!==e.data("lastHeight")&&(e.data("lastHeight",t),t>e.clientHeight&&(e.addClass("mt-scrollable"),e.on("scroll",(function(){e.scrollTop()>0&&(e.removeClass("mt-scrollable"),e.off("scroll"))}))))},L=$.widget("mt.modal",$.ui.dialog,{options:{dialogClass:"mt-dialog",modal:!0,width:400,resizable:!1,draggable:!1,appendTo:"#mt-modal-container",tabs:!1,naming:null,title:null,content:null,params:{},close:function(){$(this).remove()},load:null,beforeCreate:null,afterCreate:null,beforeDestroy:null,afterDestroy:null,requiresPage:!0},_create:function(){var e=this;$("body").addClass(H),e._trigger("beforeCreate"),e.options=C.extendObject(e.options,e.element.data()),null===e.options.naming&&null===e.options.content&&$.error("naming or content construction option is necessary"),e.element.addClass("mt-modal"),e.options.tabs&&e.element.addClass("with-tabs"),"string"==typeof e.options.naming?e.templateSpace={template:"MindTouch/Controls/Dialogs/"+e.options.naming.charAt(0).toUpperCase()+e.options.naming.slice(1),javascript:"dialog."+(e.options.naming.charAt(0).toLowerCase()+e.options.naming.slice(1)),namespace:e.options.naming.charAt(0).toUpperCase()+e.options.naming.slice(1)}:e.templateSpace=e.options.naming,e._super(arguments),e._trigger("afterCreate")},open:function(){var e=this;e.widget().trigger("focusin"),e.widget().on("dialoginit",(function(){e._afterDialogInit()})),e._super(),e.load()},close:function(){this._super(),this._destroy()},load:function(){var e=this;if(e.options.content){var t=$(document.createElement("div"));t.addClass("mt-dialog-root").data("title",e.options.title||"").html(e.options.content),e._insertUi(t)}else e._loadUi(e.templateSpace,e.options.params)},_loadViewUi:function(e,t){var r=this;t||(t={}),this.options.requiresPage&&(t.pageid=m("pageId"),0===t.pageid&&(t.pageid="="+document.location.pathname.replace(/^\/+/g,""))),function(){var e=m("pageContentViewParser"),t={};return e&&(t["mt-view"]=e),new M(window.location.origin).at("@app").withParams(t)}().at("layout","views","".concat(e,".html")).withParams(t).get().then((function(e){return e.text()})).then((function(e){r._insertUi($(e))}))},_loadUi:function(e,t){"view"in e&&this._loadViewUi(e.view,t)},_insertUi:function(e){var t=this;e.each((function(){var e=$(this);e.hasClass("mt-dialog-root")?(t.options.tabs?e.parent().find(".ui-dialog-titlebar-close").prependTo("#link-picker-tabs").closest(".ui-dialog").children(".ui-dialog-titlebar").remove():t._setOption("title",e.data("title")),t.$wrapper=e.appendTo(t.element).parents(".ui-dialog").addClass("mt-modal-wrapper")):e.is("script")&&$("body").append(e)})),t._trigger("load")},_afterDialogInit:function(){var e=this,t=e.$wrapper.find(".mt-scrolling-dialog-content");if(F(t),"function"==typeof MutationObserver&&t.length&&(e.observer=new MutationObserver((function(){F(t)})),e.observer.observe(t.get(0),{childList:!0,subtree:!0})),e.options.tabs&&e.$wrapper&&"auto"===e.options.height){var r=e.$wrapper.outerHeight(),n=e.$wrapper.addClass("mt-modal-wrapper-tabs").find(".ui-dialog-titlebar").outerHeight();e.element.css("top",-1*n),e.$wrapper.height(r-n)}e.option("position",{my:"center",at:"center",of:window})},_destroy:function(){var e=this;e._trigger("beforeDestroy"),"object"===r(e.observer)&&e.observer.disconnect(),$("body").removeClass(H),e.element.removeClass("mt-modal"),$(document).off(".mt-modal"),e._super(),e.$wrapper&&e.$wrapper.length&&e.$wrapper.remove(),e._trigger("afterDestroy")}}),z=m("clientSideWarnings"),Q=["aria-label","aria-checked","role"];function B(e){return e&&(e.nodeType===Node.ELEMENT_NODE||e.nodeType===Node.TEXT_NODE||e.nodeType===Node.DOCUMENT_FRAGMENT_NODE)}function G(e){var t=r(e);return"string"===t||"number"===t||"boolean"===t||"function"===t}function V(e,t){t.forEach((function(t){W(e,t)}))}function W(e,t){var r,n,s,o=!0;return Array.isArray(t)?V(e,t):B(t)?e.appendChild(t):"string"==typeof t?(r=e,n=t,s=document.createTextNode(n),r.appendChild(s)):t instanceof Promise?function(e,t){var r=X("div");e.appendChild(r),t.then((function(t){if(B(t))e.replaceChild(t,r);else if(B(t.element))e.replaceChild(t.element,r);else if("string"==typeof t){var n=document.createTextNode(t);e.replaceChild(n,r)}else e.removeChild(r)}))}(e,t):o=!1,o}function X(e,t){var n=document.createElement(e);if(t){W(n,t)||null===t||"object"!==r(t)||Object.keys(t).forEach((function(r){if(r in n||(o=r,Q.includes(o)||o.startsWith("@"))){var s=t[r];"style"===r?function(e,t){Object.keys(t).forEach((function(r){r in e.style?e.style[r]=t[r]:z&&console.warn("".concat(r," is not a valid style for a <").concat(e.tagName.toLowerCase(),">"))}))}(n,s):"dataset"===r?function(e,t){Object.keys(t).forEach((function(r){var n=t[r];G(n)?e.dataset[r]=n:z&&console.warn("Unable to set data property ".concat(n," on <").concat(e.tagName.toLowerCase(),">"))}))}(n,s):Q.includes(r)?n.setAttribute(r,s):r.startsWith("@")?n.setAttribute(r.substring(1),s):G(s)?n[r]=s:z&&console.warn("Unable to set value ".concat(s," for property ").concat(r," of a <").concat(e,">"))}else z&&console.warn("".concat(r," is not a valid property of a <").concat(e,">"));var o}));for(var s=arguments.length,o=new Array(s>2?s-2:0),i=2;i<s;i++)o[i-2]=arguments[i];o&&o.length>0&&V(n,o)}return n}new DOMParser;var Y=function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return X.apply(void 0,["button"].concat(t))},K=function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return X.apply(void 0,["div"].concat(t))},Z=function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return X.apply(void 0,["p"].concat(t))},ee=function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return X.apply(void 0,["span"].concat(t))},te={getDialogHtml:function(e){var t=[Y({id:"mt-dialog-confirmation-submit",type:"button",className:"ui-button ".concat(e.reverseButtons?"":"ui-button-primary"),role:"button",dataset:e.gaConfirmLabel?{gaLabel:e.gaConfirmLabel}:{}},[e.buttonYes]),Y({id:"mt-dialog-confirmation-cancel",type:"button",className:"ui-button ".concat(e.reverseButtons?"ui-button-primary":""),role:"button",dataset:e.gaCancelLabel?{gaLabel:e.gaCancelLabel}:{}},[e.buttonCancel])];e.reverseButtons&&(t=t.reverse()),e.f1&&t.unshift(function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return X.apply(void 0,["a"].concat(t))}({className:"F1 mt-f1-link",title:e.f1.label,href:"https://expert-help.nice.com/@go/cid/".concat(e.f1.contentID),target:"_blank"},[ee({className:"ui-icon mt-icon-f1-link"}),e.f1.label]));var r={title:e.title};return e.gaAction&&(r.gaAction=e.gaAction),K({className:"mt-dialog-root",dataset:r},[K({className:"mt-scrolling-dialog-content"},K({className:"mt-dialog-confirmation mt-dialog-content"},Z(e.message),e.content&&document.createTextNode(e.content))),K({className:"mt-dialog-button-container"},[K({className:"ui-dialog-buttonset"},t)])])},init:function(e,t){var r=this;return new Promise((function(n,s){var o=r.getDialogHtml(e),i=$("<div></div>");L({width:550,modal:!0,resizable:!1,dialogClass:"mt-dialog",draggable:!1,content:o,title:e.title||null,load:function(){$("#mt-dialog-confirmation-submit").on("click",(function(){n(),t||i.remove()})),$("#mt-dialog-confirmation-cancel").on("click",(function(){s(),t||i.remove()})),t&&t.then((function(){i.remove()}))},close:function(){s(),t||i.remove()}},i)}))}},re={_plug:new P(m("baseHref")+"/").at("@api","deki","workflow","submit-feedback").withParam("dream.out.format","json"),submit:function(e){var t=new $.Deferred,r=e.path||T(window.location.pathname,"/"),n=e.userEmail,s=e.pageTitle,o=e.siteUrl,i=JSON.stringify({_path:encodeURIComponent(r),userEmail:n,pageTitle:s,siteUrl:o,content:e.content,contactAllowed:e.contactAllowed});return this._plug.post(i,C.jsonRequestType,(function(e){if(e.isSuccess()){var r=JSON.parse(e.responseText);t.resolve(r)}else t.reject(e.getStatusText())})),t.promise()},getRatingsForPages:function(e){var t=new $.Deferred;return new P(m("baseHref")+"/").at("@api","deki","pages","ratings").withParam("dream.out.format","json").withParams({pageids:e.join(",")}).get((function(e){if(e.isSuccess()){var r=e.getJson();"@count"in r&&parseInt(r["@count"],10)>0?t.resolve(C.makeArray(r.page)):t.resolve([])}else t.reject()})),t.promise()}},ne={Loaded:"Events.Template.Loaded"},se=function(){function e(t){if(n(this,e),this._id=0,"number"==typeof t)this._id=t;else{var r=Number(t);isNaN(r)?"string"==typeof t&&this.setPath(t):this._id=r}this._pagePlug=new P(m("baseHref")+"/").at("@api","deki","pages").withParam("dream.out.format","json"),this._historyPlug=new P(m("baseHref")+"/").at("@api","deki","events","page").withParam("dream.out.format","json")}return o(e,[{key:"setPath",value:function(e){this._id="home"===e.toLowerCase()?"home":"="+encodeURIComponent(e)}},{key:"getPlug",value:function(){return this._pagePlug.at(this._id)}},{key:"getHistoryPlug",value:function(){return this._historyPlug.at(this._id)}},{key:"setId",value:function(e){this._id=e}},{key:"getFullInfo",value:function(e,t){return this._doGet(null,"error.fullInfo.fetch",e,t)}},{key:"getInfo",value:function(e,t){return t||"object"!==r(e)?t&&!("exclude"in t)&&(t.exclude="revision"):"exclude"in e||(e.exclude="revision"),this._doGet("info","error.simpleInfo.fetch",e,t)}},{key:"getContents",value:function(e,t){return this._doGet("contents","error.contents.fetch",e,t)}},{key:"getSubpages",value:function(e,t){return this._doGet("subpages","error.subpages.fetch",e,t)}},{key:"getTree",value:function(e,t){return this._doGet("tree","error.tree.fetch",e,t)}},{key:"getTreeIds",value:function(){var e=new $.Deferred;return this._pagePlug.at(this._id,"tree").withParams({format:"ids"}).get((function(t){t.isSuccess()?e.resolve(t.responseText.split(",")):e.reject(t.getError())})),e.promise()}},{key:"getTags",value:function(e,t){return this._doGet("tags","error.tags.fetch",e,t)}},{key:"getJsonTemplate",value:function(e,t,r){r=r||{},t=t||function(){};var n="="+encodeURIComponent(encodeURIComponent(e)),s=r;s.pageid=this._id.toString(),s.format="text",this._pagePlug.at(n,"contents").withParams(s).get((function(e){if(e.isSuccess())try{var r=JSON.parse(e.responseText);t({success:!0,data:r})}catch(r){t({success:!1,error:{type:"error.template.json.parse",status:e.getStatusText()}})}else t({success:!1,error:{type:"error.template.json.fetch",status:e.getStatusText()}})}))}},{key:"getHtmlTemplate",value:function(e,t,n){var s=new $.Deferred;if("function"==typeof t)n=n||{};else{if(t&&"object"!==r(t))throw new Error("Error: The second parameter to getHtmlTemplate must be an object or function");n=t||{},t=C.finishDeferred(s)}var o="="+encodeURIComponent(encodeURIComponent(e)),i=n;return i.pageid=this._id.toString(),this._pagePlug.at(o,"contents").withParams(i).get((function(e){if(e.isSuccess()){var r=e.getJson();t({success:!0,data:r}),$(document).trigger(ne.Loaded)}else t({success:!1,error:{type:"error.template.html.fetch",status:e.getStatusText()}})})),s.promise()}},{key:"logPageView",value:function(){return(new $.Deferred).promise()}},{key:"getOverview",value:function(){var e=new $.Deferred;return this.getPlug().at("overview").get((function(t){t.isSuccess()?e.resolve(t.getJson()):e.reject({error:{type:"error.overview.fetch",status:t.getStatusText()}})})),e.promise()}},{key:"getUserRating",value:function(){var e=new $.Deferred;return this._pagePlug.at(this._id,"ratings").get((function(t){if(t.isSuccess()){var r=t.getJson();"user.ratedby"in r?e.resolve(r["user.ratedby"]):e.resolve({})}else e.reject({error:{type:"error.userrating.fetch",status:t.getStatusText()}})})),e.promise()}},{key:"rate",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",r=new $.Deferred;return this._pagePlug.at(this._id,"ratings").withParams({score:e,previousScore:t}).post(C.textRequestType,"",(function(e){e.isSuccess()?r.resolve():r.reject({error:{type:"error.userrating.set",status:e.getStatusText()}})})),r.promise()}},{key:"pdf",value:function(e){var t=new $.Deferred;return e.dryrun=!1!==e.dryrun||e.dryrun,this._pagePlug.at(this._id,"pdf").withParams(e).get((function(r){if(r.isSuccess())""!==r.responseText&&e.dryrun?t.resolve(JSON.parse(r.responseText)):t.resolve();else{var n={};400===r.status?(n.type="export.too-many-pages",n.info=JSON.parse(r.responseText)):n.type="export.general",t.reject(n)}})),t.promise()}},{key:"getRelated",value:function(e){var t=new $.Deferred;return this.getPlug().at("related").withParams(e).get((function(e){e.isSuccess()?t.resolve(e.getJson()):t.reject({error:{type:"error.related.fetch",status:e.getStatusText()}})})),t.promise()}},{key:"_doGet",value:function(e,t,n,s){var o=new $.Deferred;if("function"==typeof n)s=s||{};else{if(n&&"object"!==r(n))throw new Error("Error: The callback parameter must be an object or function");s=n||{},n=C.finishDeferred(o)}var i=this.getPlug();return e&&(i=i.at(e)),i.withParams(s).get((function(e){if(e.isSuccess()){var r=null;try{r=JSON.parse(e.responseText)}catch(t){return void n({success:!1,error:{type:"error.response.parse",status:e.getStatusText()}})}n({success:!0,data:r})}else{var s=e.getError();404===s.code&&s.data&&s.data["@virtual"]?n({success:!0,data:s.data}):n({success:!1,error:{code:s.code,type:t,status:e.getStatusText(),message:s.message}})}})),o.promise()}}]),e}(),oe=function(){function e(t){n(this,e),this._id="number"==typeof t?t:parseInt(t,10),this._plug=new P(m("baseHref")+"/").at("@api","deki","drafts").withParam("dream.out.format","json"),this._historyPlug=new P(m("baseHref")+"/").at("@api","deki","events","draft").withParam("dream.out.format","json")}return o(e,[{key:"setPath",value:function(e){this._id="home"===e.toLowerCase()?"home":"="+encodeURIComponent(e)}},{key:"getDrafts",value:function(e){var t=new $.Deferred;return e=e||{},this._plug.withParams(e).get((function(e){if(e.isSuccess()){var r=e.getJson();t.resolve({data:r})}else t.reject(e.getError())})),t.promise()}},{key:"revertTo",value:function(e){var t=new $.Deferred;return this.getPlug().withParams(e).at("revert").post(null,C.textRequestType,(function(e){e.isSuccess()?t.resolve():t.reject({error:{type:"error.page.revert",status:e.getStatusText()}})})),t.promise()}},{key:"setDisplayTitle",value:function(e){var t=new $.Deferred;return this.getPlug().at("title").put(e,C.textRequestType,(function(e){if(e.isSuccess()){var r=e.responseText;t.resolve(r)}else t.reject(e)})),t.promise()}},{key:"create",value:function(){var e=new $.Deferred;return this.getPlug().at("create").post("",C.textRequestType,(function(t){t.isSuccess()?e.resolve(t.getJson()):e.reject(t)})),e.promise()}},{key:"deactivate",value:function(){var e=new $.Deferred;return this.getPlug().at("deactivate").post("",C.textRequestType,(function(t){t.isSuccess()?e.resolve():e.reject(t)})),e.promise()}},{key:"publish",value:function(){var e=new $.Deferred;return this.getPlug().at("publish").post("",C.textRequestType,(function(t){t.isSuccess()?e.resolve():e.reject(t)})),e.promise()}},{key:"unpublish",value:function(){var e=new $.Deferred;return this.getPlug().at("unpublish").post("",C.textRequestType,(function(t){t.isSuccess()?e.resolve():e.reject(t)})),e.promise()}},{key:"getPlug",value:function(){return this._plug.at(this._id)}},{key:"getHistoryPlug",value:function(){return this._historyPlug.at(this._id)}}]),e}(),ie=function(){function e(t){n(this,e),this.file="base64"in t.file?t.file.encoded:t.file,this.maxFileSize=t.maxFileSize,this.tempId="file_".concat(C.guid()),this.size=t.file.size,this.name=t.file.name,this.isBase64=t.file.base64,this.contentTypeOverride=t.file.contentType,this.deleteRedirects=t.deleteRedirects}return o(e,[{key:"getFileName",value:function(){return this.name}},{key:"getFileExtension",value:function(){return function(e,t){var r=e.lastIndexOf(t);return e.substring(r+1)}(this.name,".")}},{key:"getProgressEvent",value:function(e){return C.extendObject(e,{event:"progress",filename:this.name,id:this.tempId})}},{key:"uploadFile",value:function(e){var t=this,r=new $.Deferred;e.maxFileSize&&t.size>e.maxFileSize&&r.reject({error:"file.upload.toobig",filename:t.getFileName(),fileSize:t.size,maxSize:e.maxFileSize});var n=t.getFileExtension();if("allowedExtensions"in e&&Array.isArray(e.allowedExtensions)&&e.allowedExtensions.indexOf(n.toLowerCase())<0&&r.reject({error:"file.upload.fileExtension",extension:n,filename:t.getFileName()}),"rejected"!==r.state()){var s="onProgress"in e&&"function"==typeof e.onProgress?e.onProgress:function(){},o=new XMLHttpRequest;if(o.open(this.params.method,this.params.uri,!0),this.file.type&&o.setRequestHeader("Content-Type",this.file.type),t.isBase64&&(t.contentTypeOverride&&o.setRequestHeader("Content-Type",t.contentTypeOverride),o.setRequestHeader("Content-Encoding","base64")),o.onreadystatechange=function(e){var t={};if(4===e.target.readyState){var n=e.target.status;if(n>=200&&n<=300)t=JSON.parse(e.target.responseText),r.resolve(t);else if(403===n)t.message="Article.Attach.file.upload.notAllowed",r.reject({error:t});else{try{t=JSON.parse(e.target.responseText)}catch(e){t.message="System.API.Error.file_upload_error"}r.reject({error:t})}}},o.onerror=function(){r.reject({error:"file.upload.badresponse"})},o.upload.onprogress=function(e){var r=t.getProgressEvent({loaded:e.loaded,total:e.total});s(r)},this.params.headers)for(var i in this.params.headers)this.params.headers.hasOwnProperty(i)&&o.setRequestHeader(i,this.params.headers[i]);o.setRequestHeader("X-Deki-Requested-With","XMLHttpRequest"),o.send(this.file)}return r.promise()}}]),e}(),ae=function(e){var t=$.Deferred();e.fileInput||t.reject("You must supply a file input DOM element or jQuery-selected file input");var r=e.fileInput;if(r instanceof $&&(r=e.fileInput[0]),"rejected"!==t.state()){var n=null;if(!r.base64&&r.length?n=r:r instanceof HTMLInputElement&&r.files&&(n=r.files),n){for(var s=[],o=0;o<n.length;o++)s.push(new ie({file:n[o]}));t.resolve(s,!1)}else r.base64||r.size?t.resolve(new ie({file:r}),!1):t.reject("No file selected")}return t.promise()},ue=function(e){function t(e){var r,s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"auto";return n(this,t),(r=c(this,a(t).call(this,e)))._draft=new oe(e),r.mode=s,r._restrictionRequestTmpl=function(e){return"<security>\n                <permissions.page><restriction>".concat(e.restriction,"</restriction></permissions.page>\n                <grants>\n                    <grant>\n                        <permissions><role>").concat(e.role,'</role></permissions>\n                        <user id="').concat(e.userId,'"></user>\n                    </grant>\n                </grants>\n            </security>')},r._tagsRequestTmpl=function(e){var t=e.reduce((function(e,t){return e+'<tag value="'.concat(t,'" />')}),"");return"<tags>".concat(t,"</tags>")},r}return i(t,e),o(t,[{key:"getPlug",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.mode,t=m("isDraftRequest");return"live"===e?t=!1:"draft"===e&&(t=!0),t?this._draft.getPlug():this._pagePlug.at(this._id)}},{key:"getHistoryPlug",value:function(){return"true"===new O(document.location.href).getQueryParamValue("draft")?this._draft.getHistoryPlug():this._historyPlug.at(this._id)}},{key:"getDraft",value:function(){return this._draft}},{key:"create",value:function(e,t){var r=this;if(Object.keys(e).forEach((function(t){r[t]=e[t]})),t=t||function(){},this.templateSource){var n=this,s=this.templateContentArgs;s["dream.out.format"]="xml",this._pagePlug.at("="+encodeURIComponent(this.templateSource),"contents").withParams(s).get((function(e){e.isSuccess()?(n.contents=e.responseText,n._createPage(t)):t({success:!1,error:{type:"error.template.fetch",status:e.getStatusText()}})}))}else this._createPage(t)}},{key:"move",value:function(e,t){var r=new $.Deferred;return t=t||C.finishDeferred(r),this._pagePlug.at(this._id,"move").withParams(e).post(null,"text/plain; charset=utf-8",(function(e){var r=null;if(e.isSuccess()){try{r=JSON.parse(e.responseText)}catch(r){return void t({success:!1,error:{type:"error.response.parse",status:e.getStatusText()}})}t(r?{success:!0,data:r}:{success:!1,error:{type:"error.response.parse",status:e.getStatusText()}})}else{var n=e.getError();n.status=e.getStatusText(),n.type="error.page.move",t({success:!1,error:n})}})),r.promise()}},{key:"copy",value:function(e){var t=new $.Deferred;return this._pagePlug.at(this._id,"copy").withParams(e).post(null,"text/plain; charset=utf-8",(function(e){var r=null;if(e.isSuccess()){try{r=JSON.parse(e.responseText)}catch(r){return void t.reject({error:{type:"error.response.parse",status:e.getStatusText()}})}r?t.resolve({data:r}):t.reject({error:{type:"error.response.parse",status:e.getStatusText()}})}else{var n=e.getError();n.status=e.getStatusText(),n.type="error.page.move",t.reject({error:n})}})),t.promise()}},{key:"setTags",value:function(e,t){if(t=t||function(){},Array.isArray(e)){var r=this._tagsRequestTmpl(e);this.getPlug().at("tags").withParams({"dream.in.format":"xml"}).put(r,C.xmlRequestType,(function(e){if(e.isSuccess()){var r=JSON.parse(e.responseText);t({success:!0,tags:r})}else t({success:!1,error:{type:"error.set.tags",status:e.getStatusText()}})}))}else t({success:!1,error:{type:"error.invalid.tags"}})}},{key:"setRestriction",value:function(e,t){if(t=t||function(){},e&&e.restriction&&e.userId&&e.role){var r=this._restrictionRequestTmpl(e),n={"dream.in.format":"xml"};e.cascade&&(n.cascade=e.cascade),this._pagePlug.at(this._id,"security").withParams(n).put(r,C.xmlRequestType,(function(e){if(e.isSuccess()){var r=null;try{r=JSON.parse(e.responseText)}catch(r){return void t({success:!1,error:{type:"error.response.parse",status:e.getStatusText()}})}t({success:!0,data:r})}else t({success:!1,error:{type:"error.restriction.setting",status:e.getStatusText()}})}))}else t({success:!1,error:{type:"error.restriction.config"}})}},{key:"revertTo",value:function(e){var t=new $.Deferred;return this._pagePlug.withParams(e).at(this._id,"revert").post(null,C.textRequestType,(function(e){if(e.isSuccess())try{t.resolve()}catch(e){t.reject({error:{type:"error.json.parse"}})}else t.reject({error:{type:"error.page.revert",status:e.getStatusText()}})})),t.promise()}},{key:"getExportUriInfo",value:function(e){this._pagePlug.at(this._id,"export").post("",C.jsonRequestType,(function(t){var r=null;try{r=t.getJson()}catch(t){return void e({success:!1})}e({success:!0,uri:r["uri.download"]})}))}},{key:"importArchive",value:function(e){var t=new $.Deferred,r=this;return ae({fileInput:e.fileInput}).done((function(n,s){Array.isArray(n)&&(n=n[0]),n.params=r._getImportParams(n.getFileName(),s,e.deleteRedirects),n.uploadFile({maxFileSize:e.maxFileSize,allowedExtensions:e.allowedExtensions}).done((function(e){t.resolve(e)})).fail((function(e){t.reject(e)})).progress((function(e){t.notify(e)}))})).fail((function(){t.reject({error:"file.upload.fileread"})})),t.promise()}},{key:"deletePage",value:function(e){var t=new $.Deferred;return this._pagePlug.at(this._id).withParams(e).del((function(e){e.isSuccess()?t.resolve(e.getJson()):t.reject({error:{type:"error.restriction.setting",status:e.getStatusText()}})})),t.promise()}},{key:"setOrder",value:function(e){var t=new $.Deferred;return this._pagePlug.at(this._id,"order").withParams(e).put("",C.textRequestType,(function(e){e.isSuccess()?t.resolve():t.reject()})),t.promise()}},{key:"getHeirarchy",value:function(){var e=new $.Deferred;return this._pagePlug.at(this._id,"files,subpages").get((function(t){if(t.isSuccess()){var r=JSON.parse(t.responseText);e.resolve(r)}else e.reject({error:{type:"error.template.html.fetch",status:t.getStatusText()}})})),e.promise()}},{key:"getFileInfo",value:function(){var e=new $.Deferred;return this._pagePlug.at(this._id,"info").get((function(t){if(t.isSuccess()){var r=JSON.parse(t.responseText);e.resolve(r)}else e.reject({error:{type:"error.template.html.fetch",status:t.getStatusText()}})})),e.promise()}},{key:"getPageInfoWithHeirarchy",value:function(){var e=new $.Deferred;return $.when(this.getHeirarchy(),this.getFullInfo()).done((function(t,r){var n=r.data;n.subpages=t,e.resolve(n)})),e.promise()}},{key:"setOverview",value:function(e){var t=new $.Deferred;if("body"in e){var r="<overview>".concat(function(){return(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"").replace(x,(function(e){return S[e]}))}(e.body),"</overview>");this.getPlug().at("overview").put(r,C.xmlRequestType,(function(e){e.isSuccess()?t.resolve():t.reject({error:{type:"error.overview.set",status:e.getStatusText()}})}))}else t.reject({error:"error.overview.set.notext"});return t.promise()}},{key:"setContents",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=new $.Deferred,n={edittime:"now"};return Object.keys(t).forEach((function(e){n[e]=t[e]})),this.getPlug().at("contents").withParams(n).post(e,C.textRequestType,(function(e){e.isSuccess()?r.resolve(e.getJson()):r.reject({error:{code:e.status,type:"error.contents.set",status:e.getStatusText(),message:e.errorMessage(),resourceKey:e.isJson()?e.getJson().resource:null}})})),r.promise()}},{key:"getLinks",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=new $.Deferred;return this.getPlug("live").at("linkdetails").withParam("subpages",e).withParams(t).get((function(e){e.isSuccess()?r.resolve(e.getJson()):r.reject({error:{code:e.status,type:"error.contents.set",status:e.getStatusText(),message:e.errorMessage(),resourceKey:e.getJson().resource}})})),r.promise()}},{key:"getInspections",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",r=$.Deferred(),n=this.getPlug("live").at("health");return""!==e.trim()&&(n=n.withParam("analyzers",e)),""!==t.trim()&&(n=n.withParams("type",t)),n.get((function(e){e.isSuccess()?r.resolve(e.getJson()):r.reject({error:{code:e.status,type:"error.contents.set",status:e.getStatusText(),message:e.errorMessage(),resourceKey:e.getJson().resource}})})),r.promise()}},{key:"getDiff",value:function(e,t){var r=this,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"all";return new Promise((function(s,o){r.getPlug(r._getRevisionMode()).at("diff").withParams({revision:e,previous:t,diff:n}).get((function(e){e.isSuccess()?s(e.getJson()):o({error:{code:e.status,type:"error.contents.set",status:e.getStatusText(),message:e.errorMessage(),resourceKey:e.getJson().resource}})}))}))}},{key:"getRevision",value:function(e){var t=this;return new Promise((function(r,n){t.getPlug(t._getRevisionMode()).withParam("revision",e).get((function(e){e.isSuccess()?r(e.getJson()):n({error:{code:e.status,type:"error.contents.set",status:e.getStatusText(),message:e.errorMessage(),resourceKey:e.getJson().resource}})}))}))}},{key:"_createPage",value:function(e){var t="";this.contents?t=$("<div></div>").append($(this.contents).text()).html():this.rawContents&&(t=this.rawContents);var r=encodeURIComponent(this.title),n=this;this._pagePlug.at("="+r,"contents").withParams({abort:"exists"}).withParams(this.params).post(t,"text/plain; charset=utf-8",(function(t){if(t.isSuccess()){var r=null;try{r=JSON.parse(t.responseText)}catch(r){return void e({success:!1,error:{type:"error.response.parse",status:t.getStatusText()}})}r?(n._id=parseInt(r.page["@id"],10),e({success:!0,id:r.page["@id"],path:r.page.path,title:r.page.title})):e({success:!1,error:{type:"error.invalid.response",status:t.getStatusText()}})}else 409===t.status?e({success:!1,error:{type:"error.duplicate.name",status:t.getStatusText()}}):e({success:!1,error:{type:"error.page.create",status:t.getStatusText()}})}))}},{key:"_getImportParams",value:function(e,t,r){if(t)return{uri:"/deki/gui/plugin.php",formatter:"file_upload_proxy",action:"import",pageId:this._id,format:"html"};var n={"X-Deki-Client":"mindtouch-web-javascript"},s=m("apiToken");return s&&(n["X-Deki-Token"]=s),{uri:this._pagePlug.at(this._id,"import").withParams({filename:encodeURIComponent(e),behavior:"async",allow:r?"deleteredirects":""}).getUrl(),method:"PUT",headers:n}}},{key:"_getRevisionMode",value:function(){var e="live";return new O(document.location.toString()).getQueryParamValue("draft")&&(e="draft"),e}}]),t}(se),ce=function(){function e(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},s=arguments.length>2?arguments[2]:void 0;n(this,e),this._id=t||0,this.defaultParams=r,this._mode=s,this._page=this._getPage(this._id)}return o(e,[{key:"setId",value:function(e){this._id=e,this._page=this._getPage(e)}},{key:"getData",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=new $.Deferred,n=t;return Object.keys(this.defaultParams).forEach((function(r){r in t||(n[r]=e.defaultParams[r])})),this._getPagePlug().at("files").withParams(n).get((function(e){if(e.isSuccess()){var t=e.getJson();"0"===t["@count"]&&(t.file=[]),r.resolve(C.makeArray(t.file))}else r.reject(e.getStatusText())})),r.promise()}},{key:"getPageFiles",value:function(e,t){e=e||function(){},t=t||{},this._getPagePlug().at("files").withParams(t).get((function(t){if(t.isSuccess()){var r=t.getJson();e({success:!0,data:r})}else e({success:!1,error:{type:"error.pageFiles.listingFetch",status:t.getStatusText()}})}))}},{key:"_getPage",value:function(e){return new se(e)}},{key:"_getPagePlug",value:function(){return this._page.getPlug()}}]),e}(),le=function(e){function t(e,r,s){return n(this,t),c(this,a(t).call(this,e,r,s))}return i(t,e),o(t,[{key:"attachFile",value:function(e){var t=new $.Deferred,r=this,n={fileInput:e.fileInput};return ae(n).then((function(n){(n=C.makeArray(n)).forEach((function(t){var n=t.getFileName();"fileNameOverride"in e&&(n=e.fileNameOverride),t.params=r._getAttachParams(n)}));var s={allowedExtensions:e.allowedExtensions,maxFileSize:e.maxFileSize||0,onProgress:function(){for(var t=new Array(arguments.length),r=0;r<t.length;r++)t[r]=arguments[r];t.forEach((function(t){e.onProgress&&e.onProgress(t)}))}},o=[];n.forEach((function(e){o.push(e.uploadFile(s))})),$.when.apply(this,o).done((function(){if(0===arguments.length)t.resolve(arguments[0]);else{for(var e=new Array(arguments.length),r=0;r<e.length;r++)e[r]=arguments[r];t.resolve(e)}})).fail((function(e){t.reject(e)}))})),t.promise()}},{key:"_getPage",value:function(e){return new ue(e,this._mode)}},{key:"_getAttachParams",value:function(e){var t={"X-Deki-Client":"mindtouch-web-javascript"},r=m("apiToken");return r&&(t["X-Deki-Token"]=r),{uri:this._getPagePlug().at("files",encodeURIComponent(e)).getUrl(),method:"PUT",headers:t}}}]),t}(ce),fe=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"auto";n(this,e),this._id=t,this._filesPlug=new P(m("baseHref")+"/").at("@api","deki","files").withParam("dream.out.format","json"),this.mode=r}return o(e,[{key:"setDescription",value:function(e){var t=new $.Deferred;return this.getPlug().at(this._id,"description").put(e,C.textRequestType,(function(e){if(e.isSuccess()){var r=e.getJson();t.resolve(r)}else t.reject({type:"error.files.setDescription",status:e.getStatusText()})})),t.promise()}},{key:"getRawProperty",value:function(e,t){t=t||function(){},this.getPlug().at(this._id,"properties",encodeURIComponent(e)).get((function(e){e.isSuccess()?t({success:!0,contents:e.responseText}):t({success:!1,error:{type:"error.files.getProperty",status:e.getStatusText()}})}))}},{key:"getFileRevisions",value:function(){var e=new $.Deferred;return this.getPlug().at(this._id,"revisions").get((function(t){if(t.isSuccess()){var r=t.getJson();e.resolve(r)}else e.reject({type:"error.files.getRevisions",status:t.getStatusText()})})),e.promise()}},{key:"setProperty",value:function(e,t,r,n){r=r||function(){};var s={};n&&"string"==typeof n&&""!==n&&(s.abort=n),this.getPlug().at(this._id,"properties",encodeURIComponent(e)).withParams(s).put(t,C.textRequestType,(function(e){if(e.isSuccess()){var t=e.getJson();r({success:!0,data:t})}else r({success:!1,error:{type:"error.files.setProperty",status:e.getStatusText()}})}))}},{key:"move",value:function(e){var t=new $.Deferred;return this.getPlug().at(this._id,"move").withParams(e).post(null,"text/plain; charset=utf-8",(function(e){var r=e.getJson();e.isSuccess()?t.resolve(r):t.reject({error:r})})),t.promise()}},{key:"deleteFile",value:function(e){var t=new $.Deferred;return e=e||C.finishDeferred(t),this.getPlug().at(this._id).del((function(t){t.isSuccess()?e({success:!0}):e({success:!1,error:{type:"error.files.delete",status:t.getStatusText()}})})),t.promise()}},{key:"addRevision",value:function(e){var t=new $.Deferred,r=this;return ae({fileInput:e.fileInput}).then((function(n){var s=Array.isArray(n)?n[0]:n;s.params=r._getRevisionParams(s.getFileName()),s.uploadFile({allowedExtensions:e.allowedExtensions,maxFileSize:e.maxFileSize||0}).done((function(e){t.resolve(e)})).fail((function(e){t.reject(e)})).progress((function(e){t.notify(e)}))})),t.promise()}},{key:"getInfo",value:function(e){var t=new $.Deferred;return e=e||C.finishDeferred(t),this.getPlug().at(this._id,"info").get((function(t){if(t.isSuccess())try{var r=t.getJson();e({success:!0,data:r})}catch(r){e({success:!1,error:{type:"error.files.jsonParse",status:t.getStatusText()}})}else e({success:!1,error:{type:"error.files.info",status:t.getStatusText()}})})),t.promise()}},{key:"getPlug",value:function(){return"live"===this.mode||"draft"!==this.mode&&!m("isDraftRequest")?this._filesPlug:this._filesPlug.withParam("draft","true")}},{key:"_getRevisionParams",value:function(e){return{uri:this.getPlug().at(this._id,"="+e).getUrl(),method:"PUT"}}}]),e}(),he=function(e){function t(e){return n(this,t),c(this,a(t).call(this,e))}return i(t,e),o(t,[{key:"getSiteComments",value:function(e,t){e=e||{},this._sitePlug.at("comments").withParams(e).get((function(e){if(e.isSuccess()){var r=e.getJson();"0"===r["@count"]?r.comment=[]:"1"===r["@count"]&&(r.comment=[r.comment]),t({success:!0,data:r})}else t({success:!1,error:{type:"error.comment.jsonFetch",status:e.getStatusText()}})}))}}]),t}(function(){function e(t){n(this,e),this._pageId=t,this._pagePlug=new P(m("baseHref")+"/").at("@api","deki","pages").withParam("dream.out.format","json"),this._sitePlug=new P(m("baseHref")+"/").at("@api","deki","site").withParam("dream.out.format","json")}return o(e,[{key:"getComments",value:function(e,t){e=e||{},this._pagePlug.at(this._pageId,"comments").withParams(e).get((function(e){if(e.isSuccess()){var r=e.getJson();"0"===r["@count"]?r.comment=[]:"1"===r["@count"]&&(r.comment=[r.comment]),t({success:!0,data:r})}else t({success:!1,error:{type:"error.comment.jsonFetch",status:e.getStatusText()}})}))}},{key:"deleteComment",value:function(e,t){t=t||function(){},this._pagePlug.at(this._pageId,"comments",e).del((function(e){t({status:e.isSuccess()})}))}}]),e}()),pe=function(e){function t(e){return n(this,t),c(this,a(t).call(this,e))}return i(t,e),o(t,[{key:"setProperty",value:function(e,t,r,n,s){r=r||function(){},s=s||C.textRequestType;var o={};n&&"string"==typeof n&&""!==n&&(o.abort=n),this._getPlug().at(e).withParams(o).put(t,s,(function(e){if(e.isSuccess()){var t=e.getJson();r({success:!0,data:t})}else r({success:!1,error:{type:"error.property.set",status:e.getStatusText()}})}))}},{key:"set",value:function(e){var t=new $.Deferred;if("key"in e||t.reject("No property key was defined"),"value"in e||t.reject("No property value was defined"),"rejected"!==t.state()){var r="contentType"in e?e.contentType:C.textRequestType,n={abort:"abort"in e?e.abort:"modified"};this._getPlug().at(e.key).withParams(n).put(e.value,r,(function(e){e.isSuccess()?t.resolve(e.getJson()):t.reject(e.getError())}))}return t.promise()}},{key:"deleteProperty",value:function(e,t){t=t||function(){},this._getPlug().at(e).del((function(e){t({success:e.isSuccess()})}))}},{key:"remove",value:function(e){var t=new $.Deferred;return this._getPlug().at(e).del((function(e){e.isSuccess()?t.resolve():t.reject()})),t.promise()}},{key:"_getPage",value:function(e){return new ue(e)}}]),t}(function(){function e(t){n(this,e),this._id=t||0,this._page=this._getPage(this._id)}return o(e,[{key:"setId",value:function(e){this._id=e,this._page=this._getPage(e)}},{key:"getProperties",value:function(e,t,r,n){e=e||function(){};var s={};n&&(s.depth=n),r&&(s.contentcutoff=r);var o="";if(t&&Array.isArray(t)&&t.length>0)for(var i=0;i<t.length;i++)o+=t[i]+",";s.names=o,this._getPlug().withParams(s).get((function(t){if(t.isSuccess()){var r=t.getJson();e({success:!0,data:r})}else e({success:!1,error:{type:"error.property.jsonFetch",status:t.getStatusText()}})}))}},{key:"getProperty",value:function(e,t,r){this.getProperties(t,[e],null,null,r)}},{key:"getPageProperties",value:function(e){var t=new $.Deferred,r={};return e.depth&&(r.depth=e.depth),e.maxContentSize&&(r.contentcutoff=e.maxContentSize),e.names.length>0&&(r.names=e.names.toString()),this._getPlug().withParams(r).get((function(e){e.isSuccess()?t.resolve(e.getJson()):t.reject({error:{type:"error.property.jsonFetch",status:e.getStatusText()}})})),t.promise()}},{key:"getRawProperty",value:function(e,t){t=t||function(){},this._getPlug().at(e).get((function(e){e.isSuccess()?t({success:!0,contents:e.responseText}):t({success:!1,error:{type:"error.property.jsonFetch"}})}))}},{key:"getJsonProperty",value:function(e,t){var r=new $.Deferred;return t=t||C.finishDeferred(r),this.getRawProperty(e,(function(e){if(e.success){var r=JSON.parse(e.contents);t({success:!0,data:r})}else t(e)})),r.promise()}},{key:"_getPage",value:function(e){return new se(e)}},{key:"_getPlug",value:function(){return this._page.getPlug().at("properties")}}]),e}()),ge={_searchPlug:new P(m("baseHref")+"/").at("@api","deki","site","query").withParam("dream.out.format","json"),doQuery:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1?arguments[1]:void 0,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:function(){};t.q=e,this._searchPlug.withParams(t).get((function(e){if(e.isSuccess()){var t=e.getJson();r({success:!0,data:t})}else r({success:!1,error:{type:"error.search.query",status:e.getStatusText()}})}))}},de=function(){function e(t){n(this,e),t=t||"query",this._searchPlug=new P(m("baseHref")+"/").at("@api","deki","site",t).withParam("dream.out.format","json")}return o(e,[{key:"query",value:function(e,t){var r=new $.Deferred;return t=t||C.finishDeferred(r),this._searchPlug.withParams(e).get((function(e){var r={};e.isJson()&&(r=e.getJson()),e.isSuccess()?t({success:!0,data:r,status:e.status}):t({success:!1,data:r,status:e.status})})),r.promise()}}]),e}(),me=function(){function e(){n(this,e),this._feedbackTemplate=function(e){var t='<?xml version="1.0"?>\n            <feedback>\n                <body>'.concat(e.comment,"</body>");return e.title&&(t+="<title>".concat(e.title,"</title>")),t+="<metadata>",e.templateMetadata.forEach((function(e){t+="<".concat(e.key,">").concat(e.value,"</").concat(e.key,">")})),t+="</metadata>\n            </feedback>"}}return o(e,null,[{key:"getRoles",value:function(){var t=$.Deferred();return e._getSitePlug().at("roles").get((function(e){if(e.isSuccess()){var r=JSON.parse(e.responseText);t.resolve({data:r})}else t.reject({error:{type:"error.roles.fetch",status:e.getStatusText()}})})),t.promise()}},{key:"getTag",value:function(e,t,r){var n={},s=new $.Deferred,o=new P(m("baseHref")+"/").at("@api","deki","pages","find");return 0===e.length&&0===t.length?s.reject({error:{type:"error.tags.empty"}}).promise():(Array.isArray(e)||(e=[e]),n.tags=e.join(","),n.missingclassifications=t.join(","),r&&(n.parentId=r),o.withParams(n).withParam("dream.out.format","json").get((function(e){var t=JSON.parse(e.responseText);if(e.isSuccess())s.resolve({data:t});else{var r={data:t,type:"error.tags.fetch",status:e.getStatusText()};s.reject({error:r})}})),s.promise())}},{key:"getResourceString",value:function(t){var r=new $.Deferred;if(t.key){var n=e._getSitePlug().at("localization",t.key);t.lang&&(n=n.withParam("lang",t.lang)),n.get((function(e){e.isSuccess()?r.resolve(e.responseText):r.reject(e.getError())}))}else $.error("The resource key is missing.");return r.promise()}},{key:"_getSitePlug",value:function(){return this._sitePlug||(this._sitePlug=new P(m("baseHref")+"/").at("@api","deki","site").withParams({"dream.out.format":"json"})),this._sitePlug}}]),o(e,[{key:"sendFeedback",value:function(t,r){r=r||function(){};var n=[];"metadata"in t&&Object.keys(t.metadata).forEach((function(e){n.push({key:e,value:t.metadata[e]})})),t.templateMetadata=n;var s=this._feedbackTemplate(t);e._getSitePlug().at("feedback").post(s,C.xmlRequestType,(function(e){e.isSuccess()?r({success:!0}):r({success:!1,error:{type:"error.feedback.send",status:e.getStatusText()}})}))}},{key:"getTags",value:function(t,r){r=r||function(){},e._getSitePlug().at("tags").withParams(t).get((function(e){if(e.isSuccess()){var t=JSON.parse(e.responseText);r({success:!0,data:t})}else r({success:!1,error:{type:"error.tags.fetch",status:e.getStatusText()}})}))}}]),e}(),ve=function(e){function t(){return n(this,t),c(this,a(t).call(this))}return i(t,e),o(t,null,[{key:"updateBatchTags",value:function(e){e=e||{add:[],remove:[]};var t=$.Deferred();if(0===e.add.length&&0===e.remove.length)return t.reject({error:{type:"error.tags.batch.empty"}}).promise();var r='<?xml version="1.0"?>\n            <tags>';return e.add.forEach((function(e){r+='<tag.add value="'.concat(e.name,'">'),e.pageids.forEach((function(e){r+='<page id="'.concat(e,'"></page>')})),r+="</tag.add>"})),e.remove.forEach((function(e){r+='<tag.remove value="'.concat(e.name,'">'),e.pageids.forEach((function(e){r+='<page id="'.concat(e,'"></page>')})),r+="</tag.remove>"})),r+="</tags>",me._getSitePlug().at("tags").post(r,C.xmlRequestType,(function(e){e.isSuccess()?t.resolve(e.getJson()):t.reject({error:{type:"error.tags.batch",status:e.getStatusText()}})})),t.promise()}}]),t}(me),ye={loginRequiredMessage:"You must be signed in to perform that action.",insufficientPermissionsMessage:"Your account does not have sufficient permissions to perform that action.",_toolTipTemplate:function(e){var t=e.position,r=e.message;return K({className:"tooltip-wrapper"},K({className:"tooltip-arrow ".concat(t)}),K({className:"clear"}),K({className:"tooltip"},K({className:"tooltip-text-container"},ee({className:"tooltip-text"},r))))},show:function(e,t){$(".tooltip-wrapper").remove();var r=e.offset(),n=e.outerHeight(),s={position:e.hasClass("left")||e.parent().hasClass("left")?"left":"right",message:t},o=$(this._toolTipTemplate(s));$("body").append(o);var i=r.left+"px";"right"===s.position&&(i=r.left-o.width()+e.width()+"px");o.css({top:r.top+n+"px",left:i})}};$((function(){$(document).on("click",(function(e){var t=$(e.target);t.hasClass("disabled-login")||0!==t.parents(".disabled-login").length||t.hasClass("disabled-permissions")||0!==t.parents(".disabled-permissions").length||$(".tooltip-wrapper").remove()})),$(".disabled-login a, a.disabled-login").on("click",(function(e){e.preventDefault(),ye.show($(this),ye.loginRequiredMessage)})),$(".disabled-permissions a, a.disabled-permissions").on("click",(function(e){e.preventDefault(),ye.show($(this),ye.insufficientPermissionsMessage)}))}));var we=function(){function e(t){n(this,e),this._id=t||0}return o(e,null,[{key:"getUserPlug",value:function(){return this._userPlug||(this._userPlug=new P(m("baseHref")+"/").at("@api","deki","users").withParam("dream.out.format","json")),this._userPlug}},{key:"searchUsers",value:function(t){t=t||{};var r=$.Deferred();return e.getUserPlug().at("search").withParams(t).get((function(e){if(e.isSuccess()){var t=null;try{t=e.getJson()}catch(t){return void r.reject({error:{type:"error.users.search.parse",status:e.getStatusText()}})}if(!t)return void r.reject({error:{type:"error.users.search.fetch",status:e.getStatusText()}});t.user=C.makeArray(t.user),r.resolve({data:t})}else{var n=null;try{n=e.getJson()}catch(e){}var s=n||{};r.reject({error:{response:s,type:"timeout"===e.statusText?"error.users.search.timeout":s["@error-code"]||"error.users.search.generic",status:e.getStatusText()}})}}),null,{timeout:3e4}),r.promise()}},{key:"getCurrentUser",value:function(t){var r=this,n=new $.Deferred,s=e.getUserPlug().at("current");return t&&Array.isArray(t)&&t.length&&(s=s.withParam("exclude",t.join())),s.get((function(e){if(e.isSuccess()){var t=r.newUserFromResponseJSON(e.getJson());n.resolve(t)}else n.reject({error:{type:"error.user.get",status:e.getStatusText()}})})),n.promise()}},{key:"newUserFromResponseJSON",value:function(t){return new e(t["@id"])}}]),o(e,[{key:"isAnonymous",value:function(){return 2===parseInt(this._id,10)}},{key:"getProperties",value:function(t){t=t||function(){},e.getUserPlug().at(this._id,"properties").get((function(e){if(e.isSuccess()){var r=null;try{r=e.getJson()}catch(r){return void t({success:!1,error:{type:"error.response.parse",status:e.getStatusText()}})}if(!r)return void t({success:!1,error:{type:"error.response.fetch",status:e.getStatusText()}});t({success:!0,data:r})}else t({success:!1,error:{type:"error.response.fetch",status:e.getStatusText()}})}))}},{key:"getProperty",value:function(t,r){r=r||function(){},e.getUserPlug().at(this._id,"properties",t).get((function(e){e.isSuccess()?r({success:!0,contents:e.responseText}):r({success:!1,error:{type:"error.property.fetch",status:e.getStatusText()}})}))}},{key:"getJsonProperty",value:function(e,t){t=t||function(){},this.getProperty(e,(function(e){if(e.success){var r=null;try{r=JSON.parse(e.contents)}catch(r){return void t({success:!1,error:{type:"error.response.parse",status:e.getStatusText()}})}if(!r)return void t({success:!1,error:{type:"error.response.fetch",status:e.getStatusText()}});t({success:!0,data:r})}else t({success:!1,error:{type:"error.property.fetch",status:e.getStatusText()}})}))}},{key:"setProperty",value:function(t,r,n,s,o){n=n||function(){},o=o||C.textRequestType;var i={};s&&"string"==typeof s&&""!==s&&(i.abort=s),e.getUserPlug().at(this._id,"properties",t).withParams(i).put(r,o,(function(e){if(e.isSuccess()){var t=null;try{t=e.getJson()}catch(t){n({success:!1,error:{type:"error.property.set.parse",status:e.getStatusText()}})}if(!t)return void n({success:!1,error:{type:"error.property.set.fetch",status:e.getStatusText()}});n({success:!0,data:t})}else n({success:!1,error:{type:"error.property.set",status:e.getStatusText()}})}))}},{key:"logUserSearch",value:function(e){var t=new $.Deferred;return new P(m("baseHref")+"/").at("@api","deki","events","search","current").post(JSON.stringify(e),C.jsonRequestType,(function(e){e.isSuccess()?t.resolve():t.reject({error:{type:"error.activity.set",status:e.getStatusText()}})})),t.promise()}}]),e}();window.Deki=Object.assign(window.Deki||{},{Feedback:re,File:fe,Logger:e,PageComment:he,PageProperty:pe,Page:ue,PagePro:ue,PageFile:le,Plug:P,Search:ge,Site:ve,SiteSearch:de,Uri:O,User:we,Ui:{Dialog:{confirmation:te},Tooltips:ye},provide:function(e){for(var t=window,r=e.split("."),n=0,s=r.length;n<s;n++)t[r[n]]=t[r[n]]||{},t=t[r[n]];return t},Log:function(e){"undefined"!=typeof console&&console.log&&console.log(e)}})}();